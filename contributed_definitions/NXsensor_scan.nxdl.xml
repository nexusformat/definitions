<?xml version="1.0" ?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<definition category="application" extends="NXobject" name="NXsensor_scan" type="group" xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <doc>
         Application definition for a generic scan using sensors.
         
         In this application definition, times should be specified always together
         with an UTC offset.
    </doc>
    <group type="NXentry">
        <field name="definition" type="NX_CHAR">
            <attribute name="version" type="NX_CHAR"/>
            <enumeration>
                <item value="NXsensor_scan"/>
            </enumeration>
        </field>
        <field name="experiment_identifier" recommended="true" type="NX_CHAR"/>
        <field name="experiment_description" type="NX_CHAR"/>
        <field name="start_time" recommended="true" type="NX_DATE_TIME"/>
        <field name="end_time" recommended="true" type="NX_DATE_TIME"/>
        <group type="NXprocess">
            <doc>
                 Define the program that was used to generate the results file(s)
                 with measured data and metadata.
            </doc>
            <field name="program" type="NX_CHAR">
                <doc>
                     Commercial or otherwise defined given name of the program
                     (or a link to the instrument software).
                </doc>
                <attribute name="version" type="NX_CHAR">
                    <doc>
                         Either version with build number, commit hash, or description of an
                         (online) repository where the source code of the program and build
                         instructions can be found so that the program can be configured in
                         such a way that result files can be created ideally in a
                         deterministic manner.
                    </doc>
                </attribute>
                <attribute name="program_url" type="NX_CHAR">
                    <doc>
                         Website of the software.
                    </doc>
                </attribute>
            </field>
        </group>
        <group type="NXuser">
            <doc>
                 Contact information of at least the user of the instrument or the
                 investigator who performed this experiment. Adding multiple users if
                 relevant is recommended.
            </doc>
            <field name="name" type="NX_CHAR">
                <doc>
                     Name of the user.
                </doc>
            </field>
            <field name="affiliation" recommended="true" type="NX_CHAR">
                <doc>
                     Name of the affiliation of the user at the point in time when
                     the experiment was performed.
                </doc>
            </field>
            <field name="address" recommended="true" type="NX_CHAR">
                <doc>
                     Full address (street, street number, ZIP, city, country)
                     of the user's affiliation.
                </doc>
            </field>
            <field name="email" recommended="true" type="NX_CHAR">
                <doc>
                     Email address of the user.
                </doc>
            </field>
            <field name="orcid" recommended="true" type="NX_CHAR">
                <doc>
                     Author ID defined by https://orcid.org/.
                </doc>
            </field>
            <field name="telephone_number" recommended="true" type="NX_CHAR">
                <doc>
                     Official telephone number of the user.
                </doc>
            </field>
        </group>
        <group type="NXinstrument">
            <group type="NXenvironment">
                <doc>
                     Describes an environment setup for the experiment.
                     
                     All the setting values of the independently scanned controllers are listed under corresponding
                     NXsensor groups. Similarly, seperate NXsensor groups are used to store the readings from each
                     measurement sensor.
                     
                     For example, in a temperature-dependent IV measurement, the temperature and voltage must be 
                     present as independently scanned controllers and the current sensor must also be present with
                     its readings.
                </doc>
                <group type="NXsensor">
                    <group recommended="true" type="NXdata">
                        <doc>
                             Plot of measured signal as a function of the timestamp of when they have been acquired is also possible.
                        </doc>
                    </group>
                    <field name="value" type="NX_FLOAT" units="NX_ANY">
                        <doc>
                             For each point in the scan space, either the nominal setpoint of an independently scanned controller
                             or a representative average value of a measurement sensor is registered.
                             In case of a full multi-dimensional scan, the length of the scan space [n] is the product of the number
                             of setpoints along all independently scanned controllers.
                        </doc>
                    </field>
                    <field name="value_timestamp" recommended="true" type="NX_DATE_TIME">
                        <doc>
                             Timestamp for when the values provided in the value field were registered.
                             
                             Individual readings can be stored with their timestamps under value_log. This is to timestamp
                             the nominal setpoint or average reading values listed above in the value field.
                        </doc>
                    </field>
                    <field name="run_control" recommended="true" type="NX_CHAR">
                        <attribute name="description" type="NX_CHAR">
                            <doc>
                                 Free-text describing the data acquisition control: an internal
                                 sweep using the built-in functionality of the controller device,
                                 or a set/wait/read/repeat mechanism.
                            </doc>
                        </attribute>
                    </field>
                    <field name="calibration_time" type="NX_DATE_TIME">
                        <doc>
                             ISO8601 datum when calibration was last performed
                             before this measurement. UTC offset should be specified.
                        </doc>
                    </field>
                </group>
                <group type="NXpid"/>
                <field name="independent_controllers" type="NX_CHAR">
                    <doc>
                         A list of names of NXsensor groups used as independently scanned controllers.
                    </doc>
                </field>
                <field name="measurement_sensors" type="NX_CHAR">
                    <doc>
                         A list of names of NXsensor groups used as measurement sensors.
                    </doc>
                </field>
            </group>
        </group>
        <group type="NXsample">
            <field name="name" type="NX_CHAR"/>
        </group>
        <group type="NXdata">
            <doc>
                 A scan specific representation of the measured signals as a function of the independently controlled environment settings.
                 Plot of every measured signal as a function of the timestamp of when they have been acquired is also possible.
            </doc>
        </group>
    </group>
</definition>
