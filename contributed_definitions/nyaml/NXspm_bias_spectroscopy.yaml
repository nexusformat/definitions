category: base
doc: |
  A base class for bias spectroscopy to describe the change in the physical properties
  of the sample with respect to the sweep voltage applied on a sample of STM/AFM/... experiments.
  
  In these experiments an electric potential is applied between the (conductive) sample and the probe
  (tip), and the physical properties (e.g. tunnelling current) are measured as the function of this
  potential. The potential is varied in so-called voltage sweeps and the corresponding properties are
  recorded accordingly.
type: group
NXspm_bias_spectroscopy(NXobject):
  measurement_type:
    doc: |
      The measurement type defines how current is measured under the different input variables like
      bias voltage (constant_spacing) or height (variadic_spacing) is applied during the measurement.
    enumeration: [constant_spacing, variadic_spacing]
  identifier_environment:
    exists: recommended
    doc: |
      Unique identifier for the environment defined by the user or lab. When multiple scans are performed
      in a single environment conditions or settings, the entire scan environment can be differentiated
      by this identifier. For example, scan on a sample of TiSe2 with layered of evaporated pyrene and
      annealed at 300K temperature for 5 min process.
  (NXspm_positioner):
    doc: |
      Information about the positioner PID (proportional, integral, differential feedback system),
      offset values, setpoint values and so on, while running bias voltage-tunneling current measurement.
      
      These components position the probe relative to the sample, thus help obtaining maps of the data
      across the sample surface.
    z_controller(NXpid_controller):
  (NXcircuit):
    acquisition_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The time or period (average) to acquire the data for a single bias sweep point.
    animation_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The time or period a bias sweep to be displayed.
    measurement_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The time or period taken by the circuit to measure a full bias sweep
        (duration of the voltage-current measurement measurement).
  BIAS_SWEEP(NXspm_scan_control):
    nameType: any
    doc: |
      The bias sweep scan which is is performed in the scanning probe microscopy
      experiments.
    spatial_location(NXcoordinate_system):
      doc: |
        The spatial location of the scan points.
        This would be recommended to use if there are multiple bias sweep scans
        at different locations.
      x(NX_NUMBER):
        unit: NX_LENGTH
      y(NX_NUMBER):
        unit: NX_LENGTH
      z(NX_NUMBER):
        unit: NX_LENGTH
    scan_type:
      doc: |
        This combines not only how the voltages are changed, but how the voltage values are
        correlated to a position across the sample surface, measuring sweeps are each spatial
        coordinate or mapping the response at constant voltage, etc.
        For STS experiment, the scan type is usually a single-point scan (trajectory scan).
      enumeration: [linear]
    number_of_sweeps(NX_NUMBER):
      doc: |
        The number of sweeps (a full scan from starting bias to end bias)
        taken during the bias spectroscopy.
    first_settling_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The initial time taken to settle the bias voltage at the desired value.
        On each sweep usually, the system takes time to settle to the bias voltage
        at the next value.
    end_settling_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The time (at the last sweep) to settle for the last value of the sweep.
    settling_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The time taken to settle the bias voltage at the desired value. On each sweep usually, the system
        takes time to settle the bias voltage at the next value.
    max_slew_rate(NX_NUMBER):
      unit: NX_ANY
      doc: |
        The rate at which the amplifier responds to the voltage change
        (to reach at the desired value). It defines if the tip movement and
        voltage sweep are synchronized.
    final_z(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        The z position after the sweeps are done.
    total_spectroscopy_time(NX_NUMBER):
      unit: NX_TIME
      doc: |
        The total time needed for the entire voltage sweep.
    scan_region(NXspm_scan_region):
      doc: |
        The scan region is the area of phase space or sub-phase space where the scan is
        performed.
      scan_offset_bias(NX_NUMBER):
        unit: NX_VOLTAGE
        doc: |
          The starting voltage of the bias sweep. The range of voltages for the sweep can
          be defined with scan voltage offset and scan voltage range (difference between
          minimum and maximum voltage values in a sweep)
      scan_range_bias(NX_NUMBER):
        unit: NX_VOLTAGE
        doc: |
          The range of voltages for the sweep can be defined with scan voltage offset and
          scan voltage range (difference between minimum and maximum voltage values in a
          sweep)
      scan_start_bias(NX_NUMBER):
        unit: NX_VOLTAGE
        doc: |
          The start of the bias scan voltage.
      scan_end_bias(NX_NUMBER):
        unit: NX_VOLTAGE
        doc: |
          The end value of the bias scan voltage.
    linear_sweep(NXspm_scan_pattern):
      doc: |
        In the linear sweep, the bias voltage is changed linearly from the start value
        to the end value.
      backward_sweep(NX_BOOLEAN):
        doc: |
          If the bias voltage sweep is also performed in the opposite direction.
      scan_points_bias(NX_NUMBER):
        doc: |
          The number of voltage points per sweep.
      step_size_bias(NX_NUMBER):
        unit: NX_VOLTAGE
        doc: |
          The step size between the two consecutive bias voltage values during the sweep.
      scan_time(NX_NUMBER):
        unit: NX_TIME
        doc: |
          The time taken by the scanner to scan the entire area.
      reset_bias(NX_BOOLEAN):
        doc: |
          The reset_bias defines whether the bias voltage should be reset to the starting
          value after the sweep is completed.
      (NXdata):
        nameType: any
        doc: |
          The scan data is the data collected during the scan.
          If the scan has several channels or derivatives from the channel data,
          please duplicate this NXdata group for each.
          
          To define specific current or voltage use :ref:`DATA </NXdata/DATA-field>`
          and :ref:`AXISNAME </NXdata/AXISNAME-field>`.
  
  # current:
  # unit: NX_CURRENT
  # doc: |
  # The tip current collected during the scan. Data to be plotted against
  # the axis defined in voltage field. Use this data as signal attributes.
  # voltage:
  # unit: NX_VOLTAGE
  # doc: |
  # Applied voltage on sample during the scan.

# ++++++++++++++++++++++++++++++++++ SHA HASH ++++++++++++++++++++++++++++++++++
# 17e54b4fb96d03187d3946f1352f26813987c9415f5f4645e20eb9997269a252
# <?xml version='1.0' encoding='UTF-8'?>
# <?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
# <!--
# # NeXus - Neutron and X-ray Common Data Format
# #
# # Copyright (C) 2023-2025 NeXus International Advisory Committee (NIAC)
# #
# # This library is free software; you can redistribute it and/or
# # modify it under the terms of the GNU Lesser General Public
# # License as published by the Free Software Foundation; either
# # version 3 of the License, or (at your option) any later version.
# #
# # This library is distributed in the hope that it will be useful,
# # but WITHOUT ANY WARRANTY; without even the implied warranty of
# # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# # Lesser General Public License for more details.
# #
# # You should have received a copy of the GNU Lesser General Public
# # License along with this library; if not, write to the Free Software
# # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
# #
# # For further information, see http://www.nexusformat.org
# -->
# <definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXspm_bias_spectroscopy" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
#     <doc>
#         A base class for bias spectroscopy to describe the change in the physical properties
#         of the sample with respect to the sweep voltage applied on a sample of STM/AFM/... experiments.
#         
#         In these experiments an electric potential is applied between the (conductive) sample and the probe
#         (tip), and the physical properties (e.g. tunnelling current) are measured as the function of this
#         potential. The potential is varied in so-called voltage sweeps and the corresponding properties are
#         recorded accordingly.
#     </doc>
#     <field name="measurement_type">
#         <doc>
#             The measurement type defines how current is measured under the different input variables like
#             bias voltage (constant_spacing) or height (variadic_spacing) is applied during the measurement.
#         </doc>
#         <enumeration>
#             <item value="constant_spacing"/>
#             <item value="variadic_spacing"/>
#         </enumeration>
#     </field>
#     <field name="identifier_environment" recommended="true">
#         <doc>
#             Unique identifier for the environment defined by the user or lab. When multiple scans are performed
#             in a single environment conditions or settings, the entire scan environment can be differentiated
#             by this identifier. For example, scan on a sample of TiSe2 with layered of evaporated pyrene and
#             annealed at 300K temperature for 5 min process.
#         </doc>
#     </field>
#     <group type="NXspm_positioner">
#         <doc>
#             Information about the positioner PID (proportional, integral, differential feedback system),
#             offset values, setpoint values and so on, while running bias voltage-tunneling current measurement.
#             
#             These components position the probe relative to the sample, thus help obtaining maps of the data
#             across the sample surface.
#         </doc>
#         <group name="z_controller" type="NXpid_controller"/>
#     </group>
#     <group type="NXcircuit">
#         <field name="acquisition_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The time or period (average) to acquire the data for a single bias sweep point.
#             </doc>
#         </field>
#         <field name="animation_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The time or period a bias sweep to be displayed.
#             </doc>
#         </field>
#         <field name="measurement_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The time or period taken by the circuit to measure a full bias sweep
#                 (duration of the voltage-current measurement measurement).
#             </doc>
#         </field>
#     </group>
#     <group name="BIAS_SWEEP" type="NXspm_scan_control" nameType="any">
#         <doc>
#             The bias sweep scan which is is performed in the scanning probe microscopy
#             experiments.
#         </doc>
#         <group name="spatial_location" type="NXcoordinate_system">
#             <doc>
#                 The spatial location of the scan points.
#                 This would be recommended to use if there are multiple bias sweep scans
#                 at different locations.
#             </doc>
#             <field name="x" type="NX_NUMBER" units="NX_LENGTH"/>
#             <field name="y" type="NX_NUMBER" units="NX_LENGTH"/>
#             <field name="z" type="NX_NUMBER" units="NX_LENGTH"/>
#         </group>
#         <field name="scan_type">
#             <doc>
#                 This combines not only how the voltages are changed, but how the voltage values are
#                 correlated to a position across the sample surface, measuring sweeps are each spatial
#                 coordinate or mapping the response at constant voltage, etc.
#                 For STS experiment, the scan type is usually a single-point scan (trajectory scan).
#             </doc>
#             <enumeration>
#                 <item value="linear"/>
#             </enumeration>
#         </field>
#         <field name="number_of_sweeps" type="NX_NUMBER">
#             <doc>
#                 The number of sweeps (a full scan from starting bias to end bias)
#                 taken during the bias spectroscopy.
#             </doc>
#         </field>
#         <field name="first_settling_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The initial time taken to settle the bias voltage at the desired value.
#                 On each sweep usually, the system takes time to settle to the bias voltage
#                 at the next value.
#             </doc>
#         </field>
#         <field name="end_settling_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The time (at the last sweep) to settle for the last value of the sweep.
#             </doc>
#         </field>
#         <field name="settling_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The time taken to settle the bias voltage at the desired value. On each sweep usually, the system
#                 takes time to settle the bias voltage at the next value.
#             </doc>
#         </field>
#         <field name="max_slew_rate" type="NX_NUMBER" units="NX_ANY">
#             <doc>
#                 The rate at which the amplifier responds to the voltage change
#                 (to reach at the desired value). It defines if the tip movement and
#                 voltage sweep are synchronized.
#             </doc>
#         </field>
#         <field name="final_z" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                 The z position after the sweeps are done.
#             </doc>
#         </field>
#         <field name="total_spectroscopy_time" type="NX_NUMBER" units="NX_TIME">
#             <doc>
#                 The total time needed for the entire voltage sweep.
#             </doc>
#         </field>
#         <group name="scan_region" type="NXspm_scan_region">
#             <doc>
#                 The scan region is the area of phase space or sub-phase space where the scan is
#                 performed.
#             </doc>
#             <field name="scan_offset_bias" type="NX_NUMBER" units="NX_VOLTAGE">
#                 <doc>
#                     The starting voltage of the bias sweep. The range of voltages for the sweep can
#                     be defined with scan voltage offset and scan voltage range (difference between
#                     minimum and maximum voltage values in a sweep)
#                 </doc>
#             </field>
#             <field name="scan_range_bias" type="NX_NUMBER" units="NX_VOLTAGE">
#                 <doc>
#                     The range of voltages for the sweep can be defined with scan voltage offset and
#                     scan voltage range (difference between minimum and maximum voltage values in a
#                     sweep)
#                 </doc>
#             </field>
#             <field name="scan_start_bias" type="NX_NUMBER" units="NX_VOLTAGE">
#                 <doc>
#                     The start of the bias scan voltage.
#                 </doc>
#             </field>
#             <field name="scan_end_bias" type="NX_NUMBER" units="NX_VOLTAGE">
#                 <doc>
#                     The end value of the bias scan voltage.
#                 </doc>
#             </field>
#         </group>
#         <group name="linear_sweep" type="NXspm_scan_pattern">
#             <doc>
#                 In the linear sweep, the bias voltage is changed linearly from the start value
#                 to the end value.
#             </doc>
#             <field name="backward_sweep" type="NX_BOOLEAN">
#                 <doc>
#                     If the bias voltage sweep is also performed in the opposite direction.
#                 </doc>
#             </field>
#             <field name="scan_points_bias" type="NX_NUMBER">
#                 <doc>
#                     The number of voltage points per sweep.
#                 </doc>
#             </field>
#             <field name="step_size_bias" type="NX_NUMBER" units="NX_VOLTAGE">
#                 <doc>
#                     The step size between the two consecutive bias voltage values during the sweep.
#                 </doc>
#             </field>
#             <field name="scan_time" type="NX_NUMBER" units="NX_TIME">
#                 <doc>
#                     The time taken by the scanner to scan the entire area.
#                 </doc>
#             </field>
#             <field name="reset_bias" type="NX_BOOLEAN">
#                 <doc>
#                     The reset_bias defines whether the bias voltage should be reset to the starting
#                     value after the sweep is completed.
#                 </doc>
#             </field>
#             <group type="NXdata" nameType="any">
#                 <doc>
#                     The scan data is the data collected during the scan.
#                     If the scan has several channels or derivatives from the channel data,
#                     please duplicate this NXdata group for each.
#                     
#                     To define specific current or voltage use :ref:`DATA &lt;/NXdata/DATA-field&gt;`
#                     and :ref:`AXISNAME &lt;/NXdata/AXISNAME-field&gt;`.
#                 </doc>
#             </group>
#         </group>
#     </group>
#     <!--current:
# unit: NX_CURRENT
# doc: |
# The tip current collected during the scan. Data to be plotted against
# the axis defined in voltage field. Use this data as signal attributes.
# voltage:
# unit: NX_VOLTAGE
# doc: |
# Applied voltage on sample during the scan.-->
# </definition>
