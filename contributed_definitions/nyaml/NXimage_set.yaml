category: base
doc: |
  Base class for reporting a set of images.
  
  The mostly commonly used scanning methods are supported. That is one-,
  two-, three-dimensional ROIs discretized using regular Euclidean tilings.
  
  Colloquially, an image is understood as a discretized representation of intensity distribution
  that was detected or simulated for some ROI. When discretized with regular Euclidean tilings
  the terms pixel and voxel identify the smallest discretization unit. Pixel and voxel are polygonal
  or polyhedral unit cells respectively of the underlying tiling of the ROI within the reference space.
  For all other tilings e.g. non-equispaced, the shape and size of pixel and voxel differs. Using the term
  (image) point is eventually is more appropriate for such tilings. Therefore, all docstrings in this base class
  refer to points (including pixel and voxel i.e. regular tilings).
  
  Point coordinates identify the location of the barycentre.
  
  For images in reciprocal space in practice, complex numbers are encoded via some
  formatted pair of real values. Typically, fast algorithms for computing Fourier transformations
  (FFT) are used to encode images in reciprocal (frequency) space. FFT libraries are used
  for implementing the key functionalities of these mathematical operations.
  
  Different libraries use different representations and encoding of the images.
  Details can be found in the respective sections of the typical FFT libraries documentations
  
  * `FFTW by M. Frigo and S. G. Johnson <https://www.fftw.org/fftw3_doc/Tutorial.html#Tutorial>`_
  * `Intel MKL by the Intel Co. <https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-c/2024-2/fourier-transform-functions.html>`_
  * `cuFFT by the NVidia Co. <https://docs.nvidia.com/cuda/cufft/index.html>`_
  * `NFFT by the Chemnitz group <https://www-user.tu-chemnitz.de/~potts/nfft/>`_ for non-equispaced computations
  
  Users are strongly advised to inspect carefully which specific conventions their library uses
  to enable storing and modifying the implementation of their code such that the serialized
  representations as they are detailed here for NeXus match.
  
  It is often the case that several images are combined using processing. In this case,
  the number of images which are combined in a collection is not necessarily the same
  for each collection. The NXimage_set base class addresses this logical distinction
  through the notation of image_identifier and group_identifier concepts.
  That is image_identifier are always counting from offset in increments of one.
  as each image is its own entity. By contrast, a group may contain no, or several images.
  Consequently, group_identifier are not required to be contiguous.

# for earlier variants see here
# https://github.com/FAIRmat-NFDI/nexus_definitions/commit/0682943baaef54d4a6386b5433f9721af6d3d81b
# https://en.wikipedia.org/wiki/Euclidean_tilings_by_convex_regular_polygons
symbols:
  n_img: |
    Number of images in the stack, for stacks the slowest dimension.
  n_k: |
    Number of image points along the slow dimension (k equivalent to z).
  n_j: |
    Number of image points along the fast dimension (j equivalent to y).
  n_i: |
    Number of image points along the fastest dimension (i equivalent to x).

# a key challenge is setting constraints, lets explain with contrasting two use cases:
# case 1 assuming an image is nothing but a collection of point-wise information without making explicit tiling and discretization information
# case 2 assuming that like most frequently assumed we understand an image probing Euclidean space
# assuming that we expect that the image is represented using a pixel grid because it was captured
# using sensors that are arranged on generator points of a regular tiling.
# in the first case, one should not constrain the dimensions for images beyond 1d
# because beyond 1d the question of offset and stride comes up i.e. the question which
# tiling is used to construct the sensor array
# in the second case, one should constrain the dimensions for all dimensions as otherwise
# there are no instructions how to arrange the sensors or the pixels for visualizing the image
# because the image is not just a bunch of point wise intensities
# but if the dimensions are not constrained again images in application definitions will be represented
# using different conventions.
type: group
NXimage_set(NXobject):
  (NXprocess):
    doc: |
      Details how NXdata instance were processed from detector readings/raw data.
    source(NXserialized):
      doc: |
        Resolvable data artifact (e.g. file) from which all values in the :ref:`NXdata`
        instances in this :ref:`NXimage_set` were loaded during parsing.
        
        Possibility to document from which specific other serialized resource as the source
        pieces of information were processed when using NeXus as a semantic file format
        to serialize that information differently.
        
        The group in combination with an added field *absolute_path* therein adds context.
      absolute_path(NX_CHAR):
        doc: |
          Reference to a location inside the artifact that points to the specific group of values
          that were processed if the artifacts contains several groups of values and thus
          further resolving of ambiguities is required.
    
    # mode(NX_CHAR):
    # doc: |
    # Imaging (data collection) mode of the instrument during acquisition.
    detector_identifier(NX_CHAR):
      doc: |
        Link or name of an :ref:`NXdetector` instance with which the data were
        collected.
    (NXprogram):
      doc: |
        Program used for processing.
  
  # space(NX_CHAR):
  # doc:
  # - |
  # The reference space in which the image set is defined.
  # enumeration: [real, reciprocal]
  image_1d(NXdata):
    doc: |
      One-dimensional image.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 1
        dim: (n_i,)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 1
        dim: (n_i,)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 1
        dim: (n_i,)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 1
        dim: (n_i,)
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.
  image_2d(NXdata):
    doc: |
      Two-dimensional image.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 2
        dim: (n_j, n_i)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 2
        dim: (n_j, n_i)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 2
        dim: (n_j, n_i)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 2
        dim: (n_j, n_i)
    axis_j(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fast dimension.
      dimensions:
        rank: 1
        dim: (n_j,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fast dimension.
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.
  image_3d(NXdata):
    doc: |
      Three-dimensional image.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 3
        dim: (n_k, n_j, n_i)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 3
        dim: (n_k, n_j, n_i)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 3
        dim: (n_k, n_j, n_i)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 3
        dim: (n_k, n_j, n_i)
    axis_k(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the slow dimension.
      dimensions:
        rank: 1
        dim: (n_k,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the slow dimension.
    axis_j(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fast dimension.
      dimensions:
        rank: 1
        dim: (n_j,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fast dimension.
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.
  stack_1d(NXdata):
    doc: |
      Collection of image_1d.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 2
        dim: (n_img, n_i)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 2
        dim: (n_img, n_i)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 2
        dim: (n_img, n_i)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 2
        dim: (n_img, n_i)
    group_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Group identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Group identifier
    image_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Image identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Image identifier
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.
  stack_2d(NXdata):
    doc: |
      Collection of two-dimensional images.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 3
        dim: (n_img, n_j, n_i)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 3
        dim: (n_img, n_j, n_i)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 3
        dim: (n_img, n_j, n_i)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 3
        dim: (n_img, n_j, n_i)
    group_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Group identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Group identifier
    image_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Image identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Image identifier.
    axis_j(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fast dimension.
      dimensions:
        rank: 1
        dim: (n_j,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fast dimension.
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.
  stack_3d(NXdata):
    doc: |
      Collection of three-dimensional images.
    intensity(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Intensity for real-valued images as an alternative for real.
        Magnitude of the image intensity for complex-valued data.
      dimensions:
        rank: 4
        dim: (n_img, n_k, n_j, n_i)
    real(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Real part of the image intensity per point.
      dimensions:
        rank: 4
        dim: (n_img, n_k, n_j, n_i)
    imag(NX_NUMBER):
      unit: NX_UNITLESS
      doc: |
        Imaginary part of the image intensity per point.
      dimensions:
        rank: 4
        dim: (n_img, n_k, n_j, n_i)
    complex(NX_COMPLEX):
      unit: NX_UNITLESS
      doc: |
        Image intensity as a complex number as an alternative to real and
        imaginary fields if values are stored as interleaved complex numbers.
      dimensions:
        rank: 4
        dim: (n_img, n_k, n_j, n_i)
    group_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Group identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Group identifier
    image_identifier(NX_INT):
      unit: NX_UNITLESS
      doc: |
        Image identifier
      dimensions:
        rank: 1
        dim: (n_img,)
      \@long_name(NX_CHAR):
        doc: |
          Image identifier
    axis_k(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the slow dimension.
      dimensions:
        rank: 1
        dim: (n_k,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the slow dimension.
    axis_j(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fast dimension.
      dimensions:
        rank: 1
        dim: (n_j,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fast dimension.
    axis_i(NX_NUMBER):
      unit: NX_LENGTH
      doc: |
        Point coordinate along the fastest dimension.
      dimensions:
        rank: 1
        dim: (n_i,)
      \@long_name(NX_CHAR):
        doc: |
          Point coordinate along the fastest dimension.

# ++++++++++++++++++++++++++++++++++ SHA HASH ++++++++++++++++++++++++++++++++++
# e30b4ffdf41b611d842315092e2dde22cff48f6eed0b8e568af95cdf88e899b8
# <?xml version='1.0' encoding='UTF-8'?>
# <?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
# <!--
# # NeXus - Neutron and X-ray Common Data Format
# #
# # Copyright (C) 2023-2025 NeXus International Advisory Committee (NIAC)
# #
# # This library is free software; you can redistribute it and/or
# # modify it under the terms of the GNU Lesser General Public
# # License as published by the Free Software Foundation; either
# # version 3 of the License, or (at your option) any later version.
# #
# # This library is distributed in the hope that it will be useful,
# # but WITHOUT ANY WARRANTY; without even the implied warranty of
# # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# # Lesser General Public License for more details.
# #
# # You should have received a copy of the GNU Lesser General Public
# # License along with this library; if not, write to the Free Software
# # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
# #
# # For further information, see http://www.nexusformat.org
# -->
# <!--
# a key challenge is setting constraints, lets explain with contrasting two use cases:
# case 1 assuming an image is nothing but a collection of point-wise information without making explicit tiling and discretization information
# case 2 assuming that like most frequently assumed we understand an image probing Euclidean space
# assuming that we expect that the image is represented using a pixel grid because it was captured
# using sensors that are arranged on generator points of a regular tiling.
# in the first case, one should not constrain the dimensions for images beyond 1d
# because beyond 1d the question of offset and stride comes up i.e. the question which
# tiling is used to construct the sensor array
# in the second case, one should constrain the dimensions for all dimensions as otherwise
# there are no instructions how to arrange the sensors or the pixels for visualizing the image
# because the image is not just a bunch of point wise intensities
# but if the dimensions are not constrained again images in application definitions will be represented
# using different conventions.-->
# <definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXimage_set" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
#     <!--for earlier variants see here
# https://github.com/FAIRmat-NFDI/nexus_definitions/commit/0682943baaef54d4a6386b5433f9721af6d3d81b
# https://en.wikipedia.org/wiki/Euclidean_tilings_by_convex_regular_polygons-->
#     <symbols>
#         <symbol name="n_img">
#             <doc>
#                  Number of images in the stack, for stacks the slowest dimension.
#             </doc>
#         </symbol>
#         <symbol name="n_k">
#             <doc>
#                  Number of image points along the slow dimension (k equivalent to z).
#             </doc>
#         </symbol>
#         <symbol name="n_j">
#             <doc>
#                  Number of image points along the fast dimension (j equivalent to y).
#             </doc>
#         </symbol>
#         <symbol name="n_i">
#             <doc>
#                  Number of image points along the fastest dimension (i equivalent to x).
#             </doc>
#         </symbol>
#     </symbols>
#     <doc>
#          Base class for reporting a set of images.
#          
#          The mostly commonly used scanning methods are supported. That is one-,
#          two-, three-dimensional ROIs discretized using regular Euclidean tilings.
#          
#          Colloquially, an image is understood as a discretized representation of intensity distribution
#          that was detected or simulated for some ROI. When discretized with regular Euclidean tilings
#          the terms pixel and voxel identify the smallest discretization unit. Pixel and voxel are polygonal
#          or polyhedral unit cells respectively of the underlying tiling of the ROI within the reference space.
#          For all other tilings e.g. non-equispaced, the shape and size of pixel and voxel differs. Using the term
#          (image) point is eventually is more appropriate for such tilings. Therefore, all docstrings in this base class
#          refer to points (including pixel and voxel i.e. regular tilings).
#          
#          Point coordinates identify the location of the barycentre.
#          
#          For images in reciprocal space in practice, complex numbers are encoded via some
#          formatted pair of real values. Typically, fast algorithms for computing Fourier transformations
#          (FFT) are used to encode images in reciprocal (frequency) space. FFT libraries are used
#          for implementing the key functionalities of these mathematical operations.
#          
#          Different libraries use different representations and encoding of the images.
#          Details can be found in the respective sections of the typical FFT libraries documentations
#          
#          * `FFTW by M. Frigo and S. G. Johnson &lt;https://www.fftw.org/fftw3_doc/Tutorial.html#Tutorial&gt;`_
#          * `Intel MKL by the Intel Co. &lt;https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-c/2024-2/fourier-transform-functions.html&gt;`_
#          * `cuFFT by the NVidia Co. &lt;https://docs.nvidia.com/cuda/cufft/index.html&gt;`_
#          * `NFFT by the Chemnitz group &lt;https://www-user.tu-chemnitz.de/~potts/nfft/&gt;`_ for non-equispaced computations 
#          
#          Users are strongly advised to inspect carefully which specific conventions their library uses
#          to enable storing and modifying the implementation of their code such that the serialized
#          representations as they are detailed here for NeXus match.
#          
#          It is often the case that several images are combined using processing. In this case,
#          the number of images which are combined in a collection is not necessarily the same
#          for each collection. The NXimage_set base class addresses this logical distinction
#          through the notation of image_identifier and group_identifier concepts.
#          That is image_identifier are always counting from offset in increments of one.
#          as each image is its own entity. By contrast, a group may contain no, or several images.
#          Consequently, group_identifier are not required to be contiguous.
#     </doc>
#     <group type="NXprocess">
#         <doc>
#              Details how NXdata instance were processed from detector readings/raw data.
#         </doc>
#         <group name="source" type="NXserialized">
#             <doc>
#                  Resolvable data artifact (e.g. file) from which all values in the :ref:`NXdata`
#                  instances in this :ref:`NXimage_set` were loaded during parsing.
#                  
#                  Possibility to document from which specific other serialized resource as the source
#                  pieces of information were processed when using NeXus as a semantic file format
#                  to serialize that information differently.
#                  
#                  The group in combination with an added field *absolute_path* therein adds context.
#             </doc>
#             <field name="absolute_path" type="NX_CHAR">
#                 <doc>
#                      Reference to a location inside the artifact that points to the specific group of values
#                      that were processed if the artifacts contains several groups of values and thus
#                      further resolving of ambiguities is required.
#                 </doc>
#             </field>
#         </group>
#         <!--mode(NX_CHAR):
#   doc: |
#    Imaging (data collection) mode of the instrument during acquisition.-->
#         <field name="detector_identifier" type="NX_CHAR">
#             <doc>
#                  Link or name of an :ref:`NXdetector` instance with which the data were
#                  collected.
#             </doc>
#         </field>
#         <group type="NXprogram">
#             <doc>
#                  Program used for processing.
#             </doc>
#         </group>
#     </group>
#     <!--space(NX_CHAR):
#   doc:
#   - |
#     The reference space in which the image set is defined.
#   enumeration: [real, reciprocal]-->
#     <group name="image_1d" type="NXdata">
#         <doc>
#              One-dimensional image.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
#     <group name="image_2d" type="NXdata">
#         <doc>
#              Two-dimensional image.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_j"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_j"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_j"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_j"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="axis_j" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fast dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_j"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fast dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
#     <group name="image_3d" type="NXdata">
#         <doc>
#              Three-dimensional image.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_k"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_k"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_k"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_k"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="axis_k" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the slow dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_k"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the slow dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_j" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fast dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_j"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fast dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
#     <group name="stack_1d" type="NXdata">
#         <doc>
#              Collection of image_1d.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="2">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="group_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Group identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Group identifier
#                 </doc>
#             </attribute>
#         </field>
#         <field name="image_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Image identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Image identifier
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
#     <group name="stack_2d" type="NXdata">
#         <doc>
#              Collection of two-dimensional images.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="3">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_j"/>
#                 <dim index="3" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="group_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Group identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Group identifier
#                 </doc>
#             </attribute>
#         </field>
#         <field name="image_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Image identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Image identifier.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_j" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fast dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_j"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fast dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
#     <group name="stack_3d" type="NXdata">
#         <doc>
#              Collection of three-dimensional images.
#         </doc>
#         <field name="intensity" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Intensity for real-valued images as an alternative for real.
#                  Magnitude of the image intensity for complex-valued data.
#             </doc>
#             <dimensions rank="4">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_k"/>
#                 <dim index="3" value="n_j"/>
#                 <dim index="4" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="real" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Real part of the image intensity per point.
#             </doc>
#             <dimensions rank="4">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_k"/>
#                 <dim index="3" value="n_j"/>
#                 <dim index="4" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="imag" type="NX_NUMBER" units="NX_UNITLESS">
#             <doc>
#                  Imaginary part of the image intensity per point.
#             </doc>
#             <dimensions rank="4">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_k"/>
#                 <dim index="3" value="n_j"/>
#                 <dim index="4" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="complex" type="NX_COMPLEX" units="NX_UNITLESS">
#             <doc>
#                  Image intensity as a complex number as an alternative to real and
#                  imaginary fields if values are stored as interleaved complex numbers.
#             </doc>
#             <dimensions rank="4">
#                 <dim index="1" value="n_img"/>
#                 <dim index="2" value="n_k"/>
#                 <dim index="3" value="n_j"/>
#                 <dim index="4" value="n_i"/>
#             </dimensions>
#         </field>
#         <field name="group_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Group identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Group identifier
#                 </doc>
#             </attribute>
#         </field>
#         <field name="image_identifier" type="NX_INT" units="NX_UNITLESS">
#             <doc>
#                  Image identifier
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_img"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Image identifier
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_k" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the slow dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_k"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the slow dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_j" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fast dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_j"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fast dimension.
#                 </doc>
#             </attribute>
#         </field>
#         <field name="axis_i" type="NX_NUMBER" units="NX_LENGTH">
#             <doc>
#                  Point coordinate along the fastest dimension.
#             </doc>
#             <dimensions rank="1">
#                 <dim index="1" value="n_i"/>
#             </dimensions>
#             <attribute name="long_name" type="NX_CHAR">
#                 <doc>
#                      Point coordinate along the fastest dimension.
#                 </doc>
#             </attribute>
#         </field>
#     </group>
# </definition>
