<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
#
# Copyright (C) 2022-2025 NeXus International Advisory Committee (NIAC)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="application" type="group" name="NXem" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <doc>
        Application definition for normalized representation of electron microscopy research.
        
        This application definition is a comprehensive, general description for the
        standardization of data and metadata collected using electron microscopy.
        
        NXem is designed to be used for documenting experiments or computer simulations in which
        controlled electron beams are used to study electron-beam matter interactions, to simulate this,
        to explore physical mechanisms and phenomena, or to characterize materials.
        
        *The NeXus application definition NXem defines a hierarchical data model with ten building blocks:*
        
        The data model represents a tree of concepts. The tree is constructed from groups of concepts
        representing the branches surplus fields and attributes representing leafs.
        
        *NXem an introduction for typical use cases in material characterization and simulation:*
        
        Transmission electron microscopy (TEM) and Scanning Transmission Electron Microscopy (STEM)
        Scanning Electron Microscopy (SEM)
        Scanning Electron Microscopy combined a Focused-Ion Beam (SEM/FIB)
        
        *A deeper dive into the branches of NXem:*
        
        NXem is constructed from composing and specializing base classes into the following ten categories:
        
        - The field ``definition`` specifies that the data schema is NXem. In combination with
          administrative metadata such as the ``NeXus_version`` provided by :ref:`NXroot` this
          specifies which version of NXem the instance data in a NeXus/HDF5 file are compliant with.
        - The fields ``identifier_experiment``, ``experiment_alias``, ``experiment_description`` and
          the group ``userID`` provide concepts for storing organizational metadata that
          contextualize the work within the research workflow and humans involved in this.
        - The fields ``start_time``, ``end_time`` provide concepts for framing a temporal context for the research.
        - The groups ``citeID``, ``noteID`` provide concepts for adding contextual details such as citations
          that are associated with or notes, i.e. other artifacts that are deemed relevant when reporting about a measurement
          or simulation. These groups are useful when NXem is used as a serialization format for technology-partner-agnostic
          archival of data and metadata that have been collected during a session with an electron microscope or when a
          simulation was performed.
        - The group ``sampleID`` provides concepts for storing metadata about the sample that was
          characterized or simulated during the session.
        - The group ``measurement`` provides concepts that are useful for describing a measurement
          during a session with an electron microscope. This includes the chain of events of data and metadata that
          were collected during such a session.
        - The group``simulation`` provides concepts that are useful for describing a simulation of an
          electron beam that interacts with matter. Combined with ``measurement`` this provides a data schema
          for defining a digital twin of the microscope and its optical setup.
        - The groups ``consistent_rotations``, ``NAMED_reference_frame`` provide concepts for
          reporting coordinate systems (frames of reference) and rotation conventions that clarify how data
          should be interpreted specifying the rotation of orientable objects in the microscope, its components,
          or of crystals and crystal defects in the material analyzed. These metadata support interpretation for
          downstream or on-the-fly data analyses which electron microscopes typically nowadays perform
          during a session. Examples are the indexing of diffraction patterns, image analysis in general, or
          analyses of the chemical composition.
        - The group ``roiID`` provides concepts for reporting several domain- and technique-specific
          configuration parameter and results of data processing steps that were applied.
        - The group ``profiling`` provides concepts for reporting computational details such as
          programs and libraries used, for documenting the libraries of virtual environments such as those used
          by conda or python virtual environment, including details about the computing hardware used, and
          documenting capabilities for performance analyses and benchmarking of the software or its parts.
        
        *Design choices:*
        
        Specific details about how an electron microscope was used and eventually its configuration modified differ
        between user groups. This holds also true for computer simulations of electron-beam matter interaction.
        Different peer groups in different sub-domains in electron microscopy consider different data and metadata
        relevant. NXem defines constraints on the existence and cardinality of concepts and its concept branches
        but seeks to offer a compromise. The key design pattern followed is that most branches are made optional
        or at most recommended but their child concepts conditional required. Thereby, NXem can cover a variety
        of simple but also complex use cases. An example of this parent-optional-but-children-stronger-restricted design
        is the combination of the optional group ``measurement`` with its required child
        ``measurement/instrument``: Users which report simulations are not forced to document the instrument
        but users which have characterized a sample are motivated to report about the instrument. They are though not
        necessarily required to report all the details of the instruments' components because the design pattern is-used
        applied recursively.
        
        *Inclusive design, one schema for scanning, focused-ion beam, and transmission electron microscopes:*
        
        Contrary to many other proposals of a data schema for electron microscopy, NXem seeks to highlight the similarity
        of the three fundamental types of electron microscopes that are nowadays used most routinely in academia and
        industry: An electron microscope is a beamline that provides a controlled beam of electrons combined with eventually
        beams of other particles (ions) to investigate electron/ion(-beam) matter interaction.
        This design of per-particle-type concept branches is realized in the base classes ``NXebeam_column`` and ``NXibeam_column``.
        These provide concepts for reporting the technical components that are typically used for generating a controllable
        (and typically scanning) beam of particles such as electrons or ions.
        
        Focused-ion beam capabilities are modelled by adding an optional group ``measurement/instrument/ibeam_column``.
        We foresee that this design is beneficial also in the future when research should be documented where photon-electron
        interactions via an electron microscope are combined. The current proposal though does not include such a
        ``NXpbeam_column`` base class that could be used for photon-/light-beam, i.e. laser plus optical
        beam path descriptions and components.
        
        We acknowledge that scanning and transmission electron microscopes are different types of instruments that have distinct differences
        in the electron-optical setup and the components used. What remains the same from the perspective of an observer who monitors the
        experiment inside the electron-matter interaction volume, i.e. in, on, or close to the surface of the specimen is the imaginary split
        into an upper and a lower half-space. In the upper half-space a specific but eventually differently shaped electron beam illuminates
        the specimen when comparing a scanning with a transmission electron microscope. In the lower half-space the beam or particles exit
        the specimen or end up thermalized in thick specimens.
        
        *NXem distinguishes and stores instance data based on how long they remain unchanged:*
        
        ``measurement`` provides two groups ``measurement/instrument`` and ``measurement/eventID``.
        The first group is designed for storing metadata about the instrument which do not change over the course of the session. Examples are
        the name of the technology partner who built the microscope, the microscope's serial number, or the type of lenses mounted, etc.
        The second group is designed for metadata and data that are collected during the microscope session. For these, specializations of
        ``NXdata`` specifically ``NXimage`` and ``NXspectrum`` are provided. Each ``measurement/eventID`` event can be time-stamped
        individually. Each instance of a group ``measurement/eventID`` contains ``measurement/instrument`` whose purpose
        is to store those specific state and settings of the microscope that was present during the collection of the event.
        This includes lens settings, apertures used, aberrations, and other components, etc.
        By virtue of design this reduces unnecessary repetition of metadata stored in the first group like is often observed
        in image-based archival formats like TIFF, PNG, etc.
        
        *NXem offers domain-specific classes for standardized reporting of method-specific configurations, data processing, and results:*
        
        These include ``NXem_img`` for generic and specific imaging including diffraction, ``NXem_eds`` for energy-dispersive X-ray spectroscopy,
        ``NXem_ebsd`` for electron backscatter diffraction, as well as ``NXem_eels`` for electron energy loss spectroscopy. These branches provide
        examples that proof how NeXus can be used for combining session-centric data storage with data processing. These examples are naturally
        incomplete but show at different levels of technical depth and breath how standardization can be useful even to report specifically formatted
        data representations like multi-dimensional plotting. Thereby, downstream processing using software for data analyses or research data
        management can take advantage of a standardized reporting rather than demanding for a zoo of parsers that interconvert
        between many representations.
        
        *NXem within the ecosystem of data schemata for electron microscopy:**
        
        We support the statement that substantially fewer standardized rather than many ad hoc schemata are required to facilitate the
        documentation and exchange of knowledge within electron microscopy. We tailored NXem to serve the materials science and
        materials engineering usage of electron microscopy to provide a complementary coverage to what OMERO has established for
        the bio- and life science usage of electron microscopy.
    </doc>
    <group type="NXentry" minOccurs="1" maxOccurs="unbounded">
        <field name="definition" type="NX_CHAR">
            <enumeration>
                <item value="NXem"/>
            </enumeration>
        </field>
        <group name="profiling" type="NXcs_profiling" optional="true">
            <doc>
                The configuration of the software that was used to generate this NeXus file.
            </doc>
            <group name="programID" type="NXprogram" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                <doc>
                    A collection of all programs and libraries used to generate this NeXus file.
                    Ideally, this would enable a binary recreation from the input data.
                    
                    Examples include the name and version of the libraries used to write the
                    instance. Ideally, the software which writes these NXprogram instances
                    also includes the version of the set of NeXus classes i.e. the specific set
                    of base classes, application definitions, and contributed definitions
                    with which the here described concepts can be resolved.
                    
                    For the `pynxtools library &lt;https://github.com/FAIRmat-NFDI/pynxtools&gt;`_
                    which is used by the `NOMAD &lt;https://nomad-lab.eu/nomad-lab&gt;`_
                    research data management system, it makes sense to store e.g. the GitHub
                    repository commit and respective submodule references used.
                    
                    Instances can also be used to document the modules and libraries that
                    are offered by the computational environment such as those parsed
                    from conda or python virtualenv environments.
                </doc>
                <field name="program" type="NX_CHAR">
                    <attribute name="version" type="NX_CHAR"/>
                </field>
            </group>
        </group>
        <field name="identifier_experiment" type="NX_CHAR" optional="true">
            <doc>
                A (globally) unique persistent identifier for referring to this experiment.
            </doc>
        </field>
        <field name="experiment_alias" type="NX_CHAR" optional="true">
            <doc>
                Alias (short name) which scientists can use to refer to this experiment.
            </doc>
        </field>
        <field name="experiment_description" type="NX_CHAR" optional="true">
            <doc>
                Free-text description about the experiment.
                
                Users are strongly advised to parameterize the description of their experiment
                by using respective groups and fields and base classes instead of writing prose
                into the field.
            </doc>
        </field>
        <field name="start_time" type="NX_DATE_TIME">
            <doc>
                ISO 8601 time code with local time zone offset to UTC information included
                when the microscope session started. If the application demands that time
                codes in this section of the application definition should only be used
                for specifying when the experiment was performed - and the exact
                duration is not relevant - use this start_time field.
                
                Often though it is useful to specify a time interval via setting both a start_time
                and an end_time because this enables software tools and users to collect a
                more detailed bookkeeping of the experiment.
                
                Users should be aware though that even using only start_time and end_time
                may not be sufficient to infer how long the experiment took or for how long
                data were acquired. To bookkeep more fine-grained timestamps over the
                course of the experiment is possible with start_time and end_time fields
                of respective :ref:`NXevent_data_em` instances.
            </doc>
        </field>
        <field name="end_time" type="NX_DATE_TIME" recommended="true">
            <doc>
                ISO 8601 time code with local time zone offset to UTC included when
                the microscope session ended.
                
                See docstring of the start_time field to see how to use the
                start_time and end_time together.
            </doc>
        </field>
        <group name="citeID" type="NXcite" minOccurs="0" maxOccurs="unbounded" nameType="partial"/>
        <group name="noteID" type="NXnote" minOccurs="0" maxOccurs="unbounded" nameType="partial">
            <doc>
                Collection of serialized resources associated with the experiment.
                Examples of such resources are files which are formatted using proprietary
                data models of technology partners as those generated by the control software
                of the microscope during the instrument session.
            </doc>
            <field name="type" type="NX_CHAR" recommended="true"/>
            <field name="file_name" type="NX_CHAR"/>
            <field name="checksum" type="NX_CHAR" recommended="true"/>
            <field name="algorithm" type="NX_CHAR" recommended="true"/>
        </group>
        <group name="userID" type="NXuser" minOccurs="0" maxOccurs="unbounded" nameType="partial">
            <doc>
                Information about persons who performed or were involved in the microscope
                session or simulation run.
            </doc>
            <field name="identifierNAME" type="NX_CHAR" nameType="partial" recommended="true">
                <attribute name="type" type="NX_CHAR"/>
            </field>
            <field name="name" type="NX_CHAR" optional="true">
                <doc>
                    Given (first) name and surname.
                </doc>
            </field>
            <field name="affiliation" type="NX_CHAR" optional="true">
                <doc>
                    Name of the affiliation at the point in time when the experiment was performed.
                </doc>
            </field>
            <field name="address" type="NX_CHAR" optional="true">
                <doc>
                    Postal address of the affiliation.
                </doc>
            </field>
            <field name="email" type="NX_CHAR" optional="true">
                <doc>
                    Email address at the point in time when the experiment was performed.
                    
                    Writing the most permanently used email is recommended.
                </doc>
            </field>
            <field name="telephone_number" type="NX_CHAR" optional="true">
                <doc>
                    Telephone number at the point in time when the experiment was performed.
                </doc>
            </field>
            <field name="role" type="NX_CHAR" optional="true">
                <doc>
                    User role at the point in time when the experiment was performed.
                    
                    Examples are technician operating the microscope, student, postdoc,
                    principle investigator, or guest.
                </doc>
            </field>
        </group>
        <group name="sampleID" type="NXsample" minOccurs="1" maxOccurs="unbounded" nameType="partial">
            <doc>
                A physical entity which contains material intended to be investigated.
                Sample and specimen are treated as de facto synonyms.
                Samples can be real or virtual ones as annotated via is_simulation.
                
                The suggested best practice is to call this group sample. In those cases when
                multiple samples need to be grouped inside one entry, these SAMPLE groups
                should be named using the prefix sample followed an index starting from 1, i.e.
                (sample1, sample2).
                
                There are at least two strategies how to store (meta)data when one analyzes multiple
                samples - not different ROIs on a single sample though - in one session.
                
                One strategy is to store each sample and its results under an own NXem/ENTRY.
                This is one of the most frequent use cases as during most sessions typically only a
                single sample is investigated. In this case the name of this group should be sample.
                
                If multiple samples are investigated storing each of them in their own ENTRY group eventually will
                demand unnecessary duplication of instrument details.
                
                This can be avoided by using another strategy for storing samples and their results.
                Namely, by using only one instance of NXem/ENTRY. That NXem/ENTRY should then be named,
                like in the previous case, NXem/entry1 and the samples should be named sample1, sample2, etc.,
                i.e. instances should use sample as a name prefix.
                
                In this case the collection of events should use identifier_sample to state clearly for which
                of the samples loaded the (characterization) event was detected.
                
                This concept is related to term `Specimen`_ of the EMglossary standard.
                
                .. _Specimen: https://purls.helmholtz-metadaten.de/emg/EMG_00000046
            </doc>
            <field name="is_simulation" type="NX_BOOLEAN">
                <doc>
                    Qualifier whether the sample is a real (in which case is_simulation should be set to false)
                    or a virtual one (in which case is_simulation should be set to true).
                </doc>
            </field>
            <field name="physical_form" recommended="true">
                <enumeration open="true">
                    <item value="bulk"/>
                    <item value="foil"/>
                    <item value="thin_film"/>
                    <item value="powder"/>
                </enumeration>
            </field>
            <field name="identifier_sample" type="NX_CHAR" recommended="true">
                <doc>
                    Ideally, (globally) unique persistent identifier which distinguishes this sample from all others
                    and especially the predecessor/origin from where that sample was cut off. An example of cutting off
                    is a steel sheet that is the parent sample from which a small portion was wire-eroded that
                    represents the sample that was then prepared for characterization with an electron microscope.
                    
                    The terms sample and specimen are here considered as exact synonyms.
                    
                    This field must not be used for an alias for the sample name. Instead, use name.
                    
                    In cases where multiple specimens were loaded into the microscope, the identifier has to resolve
                    the specific sample, whose results are stored by this :ref:`NXentry` instance, because a single
                    NXentry should be used for the characterization of a single specimen.
                    
                    Details about the specimen preparation should be stored in resources referring to identifier_parent.
                </doc>
                <attribute name="type" type="NX_CHAR"/>
            </field>
            <field name="identifier_parent" type="NX_CHAR" recommended="true">
                <doc>
                    Identifier of the sample from which the sample was cut off or the string *None*.
                    I.e. the parent to this sample.
                    
                    The purpose of this field is to support functionalities for tracking
                    sample provenance in a research data management system.
                </doc>
                <attribute name="type" type="NX_CHAR"/>
            </field>
            <field name="preparation_date" type="NX_DATE_TIME">
                <doc>
                    ISO 8601 time code with local time zone offset to UTC information
                    when the specimen was prepared.
                    
                    Ideally, report the end of the preparation, i.e. the last known timestamp when
                    the measured specimen surface was actively prepared. Ideally, this matches
                    the last timestamp that is mentioned in the digital resource pointed to by
                    identifier_parent.
                    
                    Knowing when the specimen was exposed to e.g. specific atmosphere is especially
                    required for material that is sensitive to the environment such as specimens that were
                    charged with fast diffusing elements or short-lived radioactive tracers.
                    
                    Additional time stamps prior to preparation_date are better placed in resources which
                    describe but do not pollute the description here with prose. Resolving these
                    connected metadata is considered the responsibility of the research data management
                    system and not the a NeXus file.
                </doc>
            </field>
            <field name="name" type="NX_CHAR" recommended="true">
                <doc>
                    Specimen name
                </doc>
            </field>
            <field name="atom_types" type="NX_CHAR">
                <doc>
                    List of comma-separated elements from the periodic table that are contained in the sample.
                    If the sample substance has multiple components, all elements from each component
                    must be included in atom_types.
                    
                    The purpose of the field is to offer research data management systems an opportunity
                    to parse the relevant elements without having to interpret these from the resources
                    pointed to by identifier_parent or walk through eventually deeply nested groups in
                    individual data instances.
                </doc>
            </field>
            <field name="thickness" type="NX_NUMBER" optional="true" units="NX_LENGTH">
                <doc>
                    (Measured) sample thickness.
                    
                    The information is recorded to qualify if the beam used was likely
                    able to shine through the specimen. For scanning electron microscopy,
                    in many cases the specimen is typically thicker than what is
                    illuminatable by the electron beam.
                    
                    In this case the value should be set to the actual thickness of the specimen
                    viewed for an illumination situation where the nominal surface normal of the
                    specimen is parallel to the optical axis.
                </doc>
            </field>
            <field name="density" type="NX_NUMBER" optional="true" units="NX_ANY">
                <doc>
                    (Measured) density of the specimen.
                    
                    For multi-layered specimens this field should only be used to describe
                    the density of the excited volume. For scanning electron microscopy
                    the usage of this field is discouraged and instead an instance of a
                    region-of-interest connected to individual :ref:`NXevent_data_em`
                    instances can provide a cleaner description of the relevant details.
                </doc>
            </field>
            <field name="description" type="NX_CHAR" optional="true">
                <doc>
                    Discouraged free-text field to provide further detail.
                </doc>
            </field>
        </group>
        <group name="consistent_rotations" type="NXparameters" recommended="true">
            <doc>
                The conventions used when reporting crystal orientations.
                We follow the best practices of the Material Science community
                that are defined in reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
            </doc>
            <field name="rotation_handedness" type="NX_CHAR">
                <doc>
                    Convention how a positive rotation angle is defined when viewing
                    from the end of the rotation unit vector towards its origin.
                    This is in accordance with convention 2 of reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
                    
                    Counter_clockwise is equivalent to a right-handed choice.
                    Clockwise is equivalent to a left-handed choice.
                </doc>
                <enumeration>
                    <item value="counter_clockwise"/>
                    <item value="clockwise"/>
                </enumeration>
            </field>
            <field name="rotation_convention" type="NX_CHAR">
                <doc>
                    How are rotations interpreted into an orientation according to convention 3
                    of reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
                </doc>
                <enumeration>
                    <item value="passive"/>
                    <item value="active"/>
                </enumeration>
            </field>
            <field name="euler_angle_convention" type="NX_CHAR">
                <doc>
                    How are Euler angles interpreted given that there are several choices (e.g. zxz, xyz)
                    according to convention 4 of reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
                    
                    The most frequently used convention in Materials Science is zxz, which is based on the work
                    of H.-J. Bunge but using other conventions is possible. Proper Euler angles are distinguished
                    from (improper) Tait-Bryan angles.
                </doc>
                <enumeration>
                    <item value="zxz"/>
                    <item value="xyx"/>
                    <item value="yzy"/>
                    <item value="zyz"/>
                    <item value="xzx"/>
                    <item value="yxy"/>
                    <item value="xyz"/>
                    <item value="yzx"/>
                    <item value="zxy"/>
                    <item value="xzy"/>
                    <item value="zyx"/>
                    <item value="yxz"/>
                </enumeration>
            </field>
            <field name="axis_angle_convention" type="NX_CHAR">
                <doc>
                    To which angular range is the rotation angle argument of an
                    axis-angle pair parameterization constrained according to
                    convention 5 of reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
                </doc>
                <enumeration>
                    <item value="rotation_angle_on_interval_zero_to_pi"/>
                </enumeration>
            </field>
            <field name="sign_convention" type="NX_CHAR">
                <doc>
                    Which sign convention is followed when converting orientations
                    between different parametrizations/representations according
                    to convention 6 of reference `&lt;https://doi.org/10.1088/0965-0393/23/8/083501&gt;`_.
                </doc>
                <enumeration>
                    <item value="p_plus_one"/>
                    <item value="p_minus_one"/>
                </enumeration>
            </field>
        </group>
        <group name="NAMED_reference_frame" type="NXcoordinate_system" minOccurs="0" maxOccurs="unbounded" nameType="partial">
            <field name="alias" type="NX_CHAR" optional="true"/>
            <field name="type" type="NX_CHAR"/>
            <field name="origin" type="NX_CHAR" recommended="true"/>
            <field name="x" type="NX_NUMBER"/>
            <field name="x_direction" type="NX_CHAR" recommended="true"/>
            <field name="y" type="NX_NUMBER"/>
            <field name="y_direction" type="NX_CHAR" recommended="true"/>
            <field name="z" type="NX_NUMBER"/>
            <field name="z_direction" type="NX_CHAR" recommended="true"/>
        </group>
        <group name="processing_reference_frame" type="NXcoordinate_system" recommended="true">
            <field name="alias" type="NX_CHAR" optional="true"/>
            <field name="type" type="NX_CHAR"/>
            <field name="origin" type="NX_CHAR" recommended="true">
                <doc>
                    Location of the origin of the processing_reference_frame.
                    
                    It is assumed that regions-of-interest in this reference frame form a rectangle or cuboid.
                    Edges are interpreted by inspecting the direction of their outer unit normals
                    (which point either parallel or antiparallel) along respective base vector direction
                    of the reference frame.
                    
                    If any of these assumptions is not met, the user is required to explicitly state this.
                </doc>
                <enumeration open="true">
                    <item value="front_top_left"/>
                    <item value="front_top_right"/>
                    <item value="front_bottom_right"/>
                    <item value="front_bottom_left"/>
                    <item value="back_top_left"/>
                    <item value="back_top_right"/>
                    <item value="back_bottom_right"/>
                    <item value="back_bottom_left"/>
                </enumeration>
            </field>
            <field name="x" type="NX_NUMBER"/>
            <field name="x_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing x-axis base vector of the
                    processing_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="y" type="NX_NUMBER"/>
            <field name="y_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing y-axis base vector of the
                    processing_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="z" type="NX_NUMBER"/>
            <field name="z_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing z-axis base vector of the
                    processing_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
        </group>
        <group name="sample_reference_frame" type="NXcoordinate_system" recommended="true">
            <field name="depends_on" type="NX_CHAR" optional="true">
                <doc>
                    Reference to the specifically named :ref:`NXsample` instance(s) for
                    which these conventions apply (e.g. /entry1/sample1).
                </doc>
            </field>
            <field name="alias" type="NX_CHAR" optional="true"/>
            <field name="type" type="NX_CHAR"/>
            <field name="origin" type="NX_CHAR" recommended="true">
                <doc>
                    Location of the origin of the sample_reference_frame.
                    
                    It is assumed that regions-of-interest in this reference frame form a rectangle or cuboid.
                    Edges are interpreted by inspecting the direction of their outer unit normals
                    (which point either parallel or antiparallel) along respective base vector direction
                    of the reference frame.
                    
                    If any of these assumptions is not met, the user is required to explicitly state this.
                </doc>
                <enumeration open="true">
                    <item value="front_top_left"/>
                    <item value="front_top_right"/>
                    <item value="front_bottom_right"/>
                    <item value="front_bottom_left"/>
                    <item value="back_top_left"/>
                    <item value="back_top_right"/>
                    <item value="back_bottom_right"/>
                    <item value="back_bottom_left"/>
                </enumeration>
            </field>
            <field name="x" type="NX_NUMBER"/>
            <field name="x_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing x-axis base vector of the
                    sample_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="y" type="NX_NUMBER"/>
            <field name="y_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing y-axis base vector of the
                    sample_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="z" type="NX_NUMBER"/>
            <field name="z_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing z-axis base vector of the
                    sample_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
        </group>
        <group name="detector_reference_frameID" type="NXcoordinate_system" nameType="partial" minOccurs="0" maxOccurs="unbounded">
            <doc>
                The reference frame that is defined by a specific detector.
            </doc>
            <field name="depends_on" type="NX_CHAR" optional="true">
                <doc>
                    Reference to the specifically named :ref:`NXdetector` instance for
                    which these conventions apply (e.g. /entry1/instrument/detector1).
                </doc>
            </field>
            <field name="alias" type="NX_CHAR" optional="true"/>
            <field name="type" type="NX_CHAR"/>
            <field name="origin" type="NX_CHAR" recommended="true">
                <doc>
                    Location of the origin of the detector_reference_frame.
                    
                    If the regions-of-interest forms a rectangle or cuboid, it is assumed that edges are interpreted
                    by inspecting the direction of their outer unit normals (which point either parallel or antiparallel)
                    along respective base vector direction of the reference frame.
                    
                    If any of these assumptions is not met, the user is required to explicitly state this.
                </doc>
                <enumeration open="true">
                    <item value="front_top_left"/>
                    <item value="front_top_right"/>
                    <item value="front_bottom_right"/>
                    <item value="front_bottom_left"/>
                    <item value="back_top_left"/>
                    <item value="back_top_right"/>
                    <item value="back_bottom_right"/>
                    <item value="back_bottom_left"/>
                </enumeration>
            </field>
            <field name="x" type="NX_NUMBER"/>
            <field name="x_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing x-axis base vector of the
                    detector_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="y" type="NX_NUMBER"/>
            <field name="y_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing y-axis base vector of the
                    detector_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
            <field name="z" type="NX_NUMBER"/>
            <field name="z_direction" type="NX_CHAR" recommended="true">
                <doc>
                    Direction of the positively pointing z-axis base vector of the
                    detector_reference_frame.
                </doc>
                <enumeration open="true">
                    <item value="north"/>
                    <item value="east"/>
                    <item value="south"/>
                    <item value="west"/>
                    <item value="in"/>
                    <item value="out"/>
                </enumeration>
            </field>
        </group>
        <group name="measurement" type="NXem_measurement" optional="true">
            <!--voltage like all other dynamic quantities should better be placed in instances of NXevent_data_em-->
            <group name="instrument" type="NXinstrument_em">
                <field name="name" type="NX_CHAR" recommended="true"/>
                <field name="location" type="NX_CHAR" recommended="true"/>
                <field name="type" type="NX_CHAR" recommended="true"/>
                <group name="fabrication" type="NXfabrication">
                    <field name="vendor" type="NX_CHAR"/>
                    <field name="model" type="NX_CHAR"/>
                    <field name="serial_number" type="NX_CHAR" recommended="true"/>
                </group>
                <group name="programID" type="NXprogram" recommended="true" nameType="partial">
                    <doc>
                        Details about the control program used for operating the microscope.
                    </doc>
                    <field name="program" type="NX_CHAR">
                        <attribute name="version" type="NX_CHAR"/>
                    </field>
                </group>
                <group name="ebeam_column" type="NXebeam_column">
                    <group name="fabrication" type="NXfabrication" optional="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                    <group name="electron_source" type="NXsource" recommended="true">
                        <field name="emitter_type" type="NX_CHAR"/>
                        <field name="probe" type="NX_CHAR" optional="true"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="lensID" type="NXelectromagnetic_lens" minOccurs="0" maxOccurs="unbounded" nameType="partial">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="apertureID" type="NXaperture" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="deflectorID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="blankerID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="monochromatorID" type="NXmonochromator" minOccurs="0" maxOccurs="unbounded" nameType="partial">
                        <field name="type" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="corrector_csID" type="NXcorrector_cs" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <doc>
                            A spherical aberration corrector is a typical component in a transmission electron microscope.
                            Many instruments have only one, in this case the variadic suffix should be dropped.
                            If there are multiple instances these should be numbered starting from 1, i.e. corrector_cs1,
                            corrector_cs2.
                        </doc>
                        <field name="name" type="NX_CHAR" recommended="true">
                            <doc>
                                Use specifically when there are multiple instances.
                            </doc>
                        </field>
                        <group name="fabrication" type="NXfabrication" recommended="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="corrector_ax" type="NXcomponent" minOccurs="0" maxOccurs="1">
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="biprismID" type="NXcomponent" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <group name="fabrication" type="NXfabrication" recommended="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="phaseplateID" type="NXcomponent" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="type" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" recommended="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="beamID" type="NXbeam" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="scan_controller" type="NXscan_controller" optional="true">
                        <group name="fabrication" type="NXfabrication" recommended="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                </group>
                <group name="ibeam_column" type="NXibeam_column" minOccurs="0" maxOccurs="1">
                    <group name="fabrication" type="NXfabrication" optional="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                    <group name="ion_source" type="NXsource">
                        <field name="emitter_type" type="NX_CHAR"/>
                        <group name="probe" type="NXatom"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="lensID" type="NXelectromagnetic_lens" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="apertureID" type="NXaperture" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="deflectorID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="blankerID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <group name="monochromatorID" type="NXmonochromator" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="type" type="NX_CHAR"/>
                        <field name="name" type="NX_CHAR"/>
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                    <!--device for correcting axial astigmatism of ion beam?-->
                    <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="beamID" type="NXbeam" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="scan_controller" type="NXscan_controller" optional="true">
                        <group name="fabrication" type="NXfabrication" optional="true">
                            <field name="vendor" type="NX_CHAR"/>
                            <field name="model" type="NX_CHAR"/>
                            <field name="serial_number" type="NX_CHAR" recommended="true"/>
                        </group>
                    </group>
                </group>
                <group name="detectorID" type="NXdetector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                    <field name="name" type="NX_CHAR"/>
                    <group name="fabrication" type="NXfabrication" recommended="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="gas_injector" type="NXcomponent" optional="true">
                    <group name="fabrication" type="NXfabrication" recommended="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="stageID" type="NXmanipulator" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                    <field name="design" type="NX_CHAR" recommended="true"/>
                    <!--add enumeration values from old NXstage_lab-->
                    <group name="fabrication" type="NXfabrication" recommended="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="nanoprobeID" type="NXmanipulator" nameType="partial" optional="true">
                    <group name="fabrication" type="NXfabrication" recommended="true">
                        <field name="vendor" type="NX_CHAR"/>
                        <field name="model" type="NX_CHAR"/>
                        <field name="serial_number" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="pumpID" type="NXpump" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                    <field name="design" type="NX_CHAR"/>
                </group>
                <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
            </group>
            <group name="eventID" type="NXevent_data_em" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                <field name="start_time" type="NX_DATE_TIME" recommended="true"/>
                <field name="end_time" type="NX_DATE_TIME" recommended="true"/>
                <field name="identifier_sample" type="NX_CHAR" recommended="true"/>
                <!--above field is another example for lacking support to define conditional existence constraints-->
                <group name="imageID" type="NXimage" minOccurs="0" maxOccurs="unbounded" nameType="partial">
                    <group type="NXprocess" recommended="true">
                        <group name="input" type="NXnote" recommended="true">
                            <field name="type" type="NX_CHAR"/>
                            <field name="file_name" type="NX_CHAR"/>
                            <field name="checksum" type="NX_CHAR"/>
                            <field name="algorithm" type="NX_CHAR"/>
                            <field name="context" type="NX_CHAR"/>
                        </group>
                        <field name="detector_identifier" type="NX_CHAR"/>
                    </group>
                    <group name="image_1d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="image_2d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="magnitude" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="image_3d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_k" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="image_4d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_m" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_k" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_1d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_group" type="NX_INT" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_image" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_2d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_group" type="NX_INT" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_image" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_3d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="real" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="imag" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="intensity" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="complex" type="NX_COMPLEX" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_group" type="NX_INT" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_image" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_k" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                </group>
                <group name="spectrumID" type="NXspectrum" minOccurs="0" maxOccurs="unbounded" nameType="partial">
                    <group type="NXprocess" recommended="true">
                        <group name="input" type="NXnote" recommended="true">
                            <field name="type" type="NX_CHAR"/>
                            <field name="file_name" type="NX_CHAR"/>
                            <field name="checksum" type="NX_CHAR"/>
                            <field name="algorithm" type="NX_CHAR"/>
                            <field name="context" type="NX_CHAR"/>
                        </group>
                        <field name="detector_identifier" type="NX_CHAR"/>
                    </group>
                    <group name="spectrum_0d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="spectrum_1d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="spectrum_2d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="spectrum_3d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_k" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_0d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_spectrum" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_1d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_spectrum" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_2d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_spectrum" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <group name="stack_3d" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="indices_spectrum" type="NX_INT">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_k" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_j" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_i" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_energy" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                </group>
                <group name="instrument" type="NXinstrument_em" recommended="true">
                    <group name="ebeam_column" type="NXebeam_column">
                        <field name="operation_mode" type="NX_CHAR" recommended="true"/>
                        <group name="electron_source" type="NXsource" optional="true">
                            <field name="voltage" type="NX_NUMBER"/>
                            <field name="extraction_voltage" type="NX_NUMBER" optional="true"/>
                            <field name="emission_current" type="NX_NUMBER" optional="true"/>
                            <field name="filament_current" type="NX_NUMBER" optional="true"/>
                        </group>
                        <group name="lensID" type="NXelectromagnetic_lens" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="power_setting" type="NX_CHAR_OR_NUMBER"/>
                        </group>
                        <group name="apertureID" type="NXaperture" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="setting" type="NX_CHAR_OR_NUMBER" recommended="true">
                                <doc>
                                    Descriptor for the aperture setting when the exact technical details
                                    are unknown or not directly controllable as the control software of
                                    the microscope does not enable or was not configured to display these
                                    values for users.
                                </doc>
                            </field>
                        </group>
                        <group name="deflectorID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="blankerID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="monochromatorID" type="NXmonochromator" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="applied" type="NX_BOOLEAN"/>
                            <field name="dispersion" type="NX_NUMBER" recommended="true"/>
                            <field name="voltage" type="NX_NUMBER" recommended="true"/>
                        </group>
                        <group name="corrector_csID" type="NXcorrector_cs" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="applied" type="NX_BOOLEAN" recommended="true"/>
                            <group name="tableauID" type="NXprocess" nameType="partial" minOccurs="1" maxOccurs="unbounded">
                                <!--model(NX_CHAR):-->
                                <!--ceos-->
                                <group name="c_1" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="a_1" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="b_2" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="a_2" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="s_3" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="a_3" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="b_4" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="d_4" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="a_4" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="s_5" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="r_5" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="a_6" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <!--nion-->
                                <group name="c_1_0" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_1_2_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_1_2_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_2_1_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_2_1_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_2_3_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_2_3_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3_0" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3_2_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3_2_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3_4_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_3_4_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_1_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_1_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_3_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_3_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_5_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_4_5_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_0" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_2_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_2_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_4_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_4_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_6_a" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                                <group name="c_5_6_b" type="NXaberration" optional="true">
                                    <field name="magnitude" type="NX_NUMBER"/>
                                </group>
                            </group>
                        </group>
                        <!--we could write down how to store the aberrations but we should not force to add aberrations
basically optional use of NXaberration therein at least some value required-->
                        <group name="corrector_ax" type="NXcomponent" optional="true">
                            <field name="applied" type="NX_BOOLEAN"/>
                            <field name="value_x" type="NX_NUMBER"/>
                            <field name="value_y" type="NX_NUMBER"/>
                        </group>
                        <group name="biprismID" type="NXcomponent" nameType="partial" optional="true"/>
                        <group name="phaseplateID" type="NXcomponent" nameType="partial" optional="true"/>
                        <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="beamID" type="NXbeam" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="scan_controller" type="NXscan_controller" recommended="true">
                            <field name="scan_schema" type="NX_CHAR"/>
                            <field name="dwell_time" type="NX_NUMBER"/>
                        </group>
                    </group>
                    <group name="ibeam_column" type="NXibeam_column" optional="true">
                        <field name="operation_mode" type="NX_CHAR" recommended="true"/>
                        <group name="ion_source" type="NXsource">
                            <group name="probe" type="NXatom"/>
                            <field name="voltage" type="NX_NUMBER"/>
                            <field name="flux" type="NX_NUMBER"/>
                        </group>
                        <group name="lensID" type="NXelectromagnetic_lens" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="power_setting" type="NX_CHAR_OR_NUMBER"/>
                        </group>
                        <group name="apertureID" type="NXaperture" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="setting" type="NX_CHAR_OR_NUMBER">
                                <doc>
                                    Descriptor for the aperture setting when the exact technical details
                                    are unknown or not directly controllable as the control software of
                                    the microscope does not enable or was not configured to display these
                                    values for users.
                                </doc>
                            </field>
                        </group>
                        <group name="deflectorID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="blankerID" type="NXdeflector" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="monochromatorID" type="NXmonochromator" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                            <field name="applied" type="NX_BOOLEAN"/>
                        </group>
                        <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="beamID" type="NXbeam" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                        <group name="scan_controller" type="NXscan_controller" recommended="true">
                            <field name="scan_schema" type="NX_CHAR"/>
                            <field name="dwell_time" type="NX_NUMBER"/>
                        </group>
                    </group>
                    <group name="optics" type="NXem_optical_system" recommended="true"/>
                    <group name="detectorID" type="NXdetector" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="operation_mode" type="NX_CHAR">
                            <doc>
                                Operation mode of the detector as displayed by the control software.
                            </doc>
                        </field>
                    </group>
                    <group name="stageID" type="NXmanipulator" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="design" type="NX_CHAR" recommended="true"/>
                        <field name="tilt1" type="NX_NUMBER"/>
                        <field name="tilt2" type="NX_NUMBER"/>
                        <field name="rotation" type="NX_NUMBER"/>
                        <field name="position" type="NX_NUMBER"/>
                        <group name="sample_heater" type="NXactuator" optional="true">
                            <field name="physical_quantity" type="NX_CHAR"/>
                            <field name="heater_current" type="NX_NUMBER" optional="true" units="NX_CURRENT">
                                <doc>
                                    Nominal current of the heater.
                                </doc>
                            </field>
                            <field name="heater_voltage" type="NX_NUMBER" optional="true" units="NX_VOLTAGE">
                                <doc>
                                    Nominal voltage of the heater.
                                </doc>
                            </field>
                            <field name="heater_power" type="NX_NUMBER" units="NX_POWER"/>
                        </group>
                    </group>
                    <group name="nanoprobeID" type="NXmanipulator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="gas_injector" type="NXcomponent" optional="true"/>
                    <group name="pumpID" type="NXpump" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="sensorID" type="NXsensor" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                    <group name="actuatorID" type="NXactuator" nameType="partial" minOccurs="0" maxOccurs="unbounded"/>
                </group>
            </group>
        </group>
        <group name="simulation" type="NXem_simulation" optional="true">
            <doc>
                Documentation for a simulation of electron beam-matter interaction.
            </doc>
            <group name="programID" type="NXprogram" nameType="partial" recommended="true">
                <doc>
                    The program with which the simulation was performed.
                </doc>
                <field name="program" type="NX_CHAR">
                    <attribute name="version" type="NX_CHAR"/>
                </field>
            </group>
            <group name="environment" type="NXcollection" recommended="true">
                <doc>
                    Programs and libraries representing the computational environment
                </doc>
                <group type="NXprogram" minOccurs="1" maxOccurs="unbounded">
                    <field name="program" type="NX_CHAR">
                        <attribute name="version" type="NX_CHAR"/>
                    </field>
                </group>
            </group>
            <group name="config" type="NXparameters" optional="true">
                <doc>
                    Configuration of the simulation
                </doc>
            </group>
            <group name="results" type="NXprocess" optional="true">
                <doc>
                    Results of the simulation
                </doc>
                <group type="NXimage" minOccurs="0" maxOccurs="unbounded"/>
                <group type="NXspectrum" minOccurs="0" maxOccurs="unbounded"/>
                <group name="interaction_volumeID" type="NXem_interaction_volume" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                    <group type="NXdata" recommended="true"/>
                    <group type="NXprocess" recommended="true"/>
                </group>
            </group>
        </group>
        <!--relevant research result post-processed for specific community methods
but normalized in its representation ready to be consumed for
research data management systems-->
        <group name="roiID" type="NXroi_process" nameType="partial" minOccurs="0" maxOccurs="unbounded">
            <doc>
                This concept is related to term `Region Of Interest`_ of the EMglossary standard.
                
                .. _Region Of Interest: https://purls.helmholtz-metadaten.de/emg/EMG_00000042
            </doc>
            <!--as soon as one entry is here constrained further
an RDM can be sure to find specific pieces of information in a
specific way but then every user of this application definition
is required to provide such information in this way!-->
            <group name="img" type="NXem_img" optional="true">
                <group name="imageID" type="NXimage" nameType="partial" minOccurs="1" maxOccurs="unbounded">
                    <field name="imaging_mode" type="NX_CHAR"/>
                </group>
            </group>
            <!--(NXmicrostructure):
exists: optional-->
            <group name="ebsd" type="NXem_ebsd" optional="true">
                <group name="gnomonic_reference_frame" type="NXcoordinate_system" recommended="true">
                    <field name="alias" type="NX_CHAR" optional="true"/>
                    <field name="type" type="NX_CHAR"/>
                    <field name="origin" type="NX_CHAR"/>
                    <field name="x" type="NX_NUMBER"/>
                    <field name="x_direction" type="NX_CHAR" recommended="true"/>
                    <field name="y" type="NX_NUMBER"/>
                    <field name="y_direction" type="NX_CHAR" recommended="true"/>
                    <field name="z" type="NX_NUMBER"/>
                    <field name="z_direction" type="NX_CHAR" recommended="true"/>
                </group>
                <group name="pattern_center" type="NXprocess" recommended="true">
                    <field name="x_boundary_convention" type="NX_CHAR"/>
                    <field name="x_normalization_direction" type="NX_CHAR"/>
                    <field name="y_boundary_convention" type="NX_CHAR"/>
                    <field name="y_normalization_direction" type="NX_CHAR"/>
                </group>
                <group name="measurement" type="NXprocess" optional="true">
                    <field name="depends_on" type="NX_CHAR"/>
                    <group name="source" type="NXnote">
                        <field name="type" type="NX_CHAR" recommended="true"/>
                        <field name="file_name" type="NX_CHAR"/>
                        <field name="checksum" type="NX_CHAR" recommended="true"/>
                        <field name="algorithm" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="simulation" type="NXprocess" optional="true">
                    <field name="depends_on" type="NX_CHAR"/>
                    <group name="source" type="NXnote">
                        <field name="type" type="NX_CHAR" recommended="true"/>
                        <field name="file_name" type="NX_CHAR"/>
                        <field name="checksum" type="NX_CHAR" recommended="true"/>
                        <field name="algorithm" type="NX_CHAR" recommended="true"/>
                    </group>
                </group>
                <group name="calibration" type="NXprocess" recommended="true"/>
                <group name="indexing" type="NXprocess" optional="true">
                    <field name="number_of_scan_points" type="NX_UINT"/>
                    <field name="indexing_rate" type="NX_NUMBER" recommended="true"/>
                    <group name="source" type="NXnote" optional="true">
                        <field name="type" type="NX_CHAR" recommended="true"/>
                        <field name="file_name" type="NX_CHAR"/>
                        <field name="checksum" type="NX_CHAR" recommended="true"/>
                        <field name="algorithm" type="NX_CHAR" recommended="true"/>
                    </group>
                    <!--per scan point quantities (identifier_phase, matching_phase, positions, etc.)
just using the implicit optional, for the database example in NOMAD we do
not wish to duplicate all payload data-->
                    <group name="phaseID" type="NXphase" nameType="partial" minOccurs="0" maxOccurs="unbounded">
                        <field name="name" type="NX_CHAR" recommended="true"/>
                        <field name="number_of_scan_points" type="NX_UINT"/>
                        <group name="unit_cell" type="NXunit_cell">
                            <field name="a" type="NX_NUMBER"/>
                            <field name="b" type="NX_NUMBER"/>
                            <field name="c" type="NX_NUMBER"/>
                            <field name="alpha" type="NX_NUMBER"/>
                            <field name="beta" type="NX_NUMBER"/>
                            <field name="gamma" type="NX_NUMBER"/>
                            <field name="space_group" type="NX_CHAR"/>
                        </group>
                    </group>
                    <!--foreseen place for phase-specific texture and microstructure representations and statistics
ipfID(NXmicrostructure_ipf):
nameType: partial
exists: ['min', '1', 'max', 'unbounded']
color_model(NX_CHAR):
projection_direction(NX_NUMBER):
map(NXdata):
\@signal(NX_CHAR):
\@axes(NX_CHAR):
\@AXISNAME_indices(NX_UINT):
nameType: partial
title(NX_CHAR):
exists: recommended
data(NX_NUMBER):
\@long_name(NX_CHAR):
axis_x(NX_NUMBER):
\@long_name(NX_CHAR):
axis_y(NX_NUMBER):
exists: optional
\@long_name(NX_CHAR):
axis_z(NX_NUMBER):
exists: optional
\@long_name(NX_CHAR):
legend(NXdata):
\@signal(NX_CHAR):
\@axes(NX_CHAR):
\@AXISNAME_indices(NX_UINT):
nameType: partial
title(NX_CHAR):
exists: recommended
data(NX_NUMBER):
\@long_name(NX_CHAR):
axis_x(NX_NUMBER):
\@long_name(NX_CHAR):
axis_y(NX_NUMBER):
\@long_name(NX_CHAR):
odfID(NXmicrostructure_odf):
nameType: partial
exists: optional
pfID(NXmicrostructure_pf):
nameType: partial
exists: optional
microstructureID(NXmicrostructure):
nameType: partial
exists: optional-->
                    <group name="roi" type="NXdata" recommended="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="descriptor" type="NX_CHAR" recommended="true"/>
                        <field name="data" type="NX_NUMBER"/>
                        <field name="axis_z" type="NX_NUMBER" optional="true">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_y" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                        <field name="axis_x" type="NX_NUMBER">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                </group>
            </group>
            <group name="eds" type="NXem_eds" optional="true">
                <!--remains to be discussed based on examples-->
                <group name="indexing" type="NXprocess">
                    <group name="summary" type="NXdata" optional="true">
                        <attribute name="signal" type="NX_CHAR"/>
                        <attribute name="axes" type="NX_CHAR"/>
                        <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                        <field name="title" type="NX_CHAR" recommended="true"/>
                        <field name="intensity" type="NX_NUMBER"/>
                        <field name="axis_energy" type="NX_CHAR">
                            <attribute name="long_name" type="NX_CHAR"/>
                        </field>
                    </group>
                    <field name="atom_types" type="NX_CHAR"/>
                    <group name="ELEMENT_SPECIFIC_MAP" type="NXimage" minOccurs="0" maxOccurs="118">
                        <field name="iupac_line_candidates" type="NX_CHAR" recommended="true"/>
                        <field name="energy_range" type="NX_NUMBER"/>
                        <group name="image_2d" type="NXdata">
                            <attribute name="signal" type="NX_CHAR"/>
                            <attribute name="axes" type="NX_CHAR"/>
                            <attribute name="AXISNAME_indices" type="NX_UINT" nameType="partial"/>
                            <field name="title" type="NX_CHAR" recommended="true"/>
                            <field name="intensity" type="NX_NUMBER">
                                <attribute name="units" type="NX_CHAR" recommended="true"/>
                            </field>
                            <field name="axis_i" type="NX_NUMBER">
                                <attribute name="long_name" type="NX_CHAR"/>
                                <attribute name="units" type="NX_CHAR"/>
                            </field>
                            <field name="axis_j" type="NX_NUMBER">
                                <attribute name="long_name" type="NX_CHAR"/>
                                <attribute name="units" type="NX_CHAR"/>
                            </field>
                        </group>
                    </group>
                </group>
            </group>
            <group name="eels" type="NXem_eels" optional="true"/>
        </group>
    </group>
    <!--see an example how to map e.g. the following flat schema https://www.zenodo.org/record/6513745 to NXem
in https://github.com/FAIRmat-NFDI/nexus_definitions/commit/0b928c4352bc5636f673b5fb25ce990f1af8a099-->
</definition>
