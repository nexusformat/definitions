<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
#
# Copyright (C) 2023-2025 NeXus International Advisory Committee (NIAC)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<!--
TODO:
- Add NXoptical_lens and NXwaveplate to NXinstrument?
- Make polfilter_TYPE(NXbeam_device) own base class -\-> rework NXpolarizer_opt. and add them to NXinstrument.
- Make spectralfilter_TYPE(NXbeam_device) own base class -\-> extend NXfilter?  and add them to NXinstrument.
- Add optical elements and rework them: NXfiber, NXbeam_splitter,
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="application" type="group" name="NXoptical_spectroscopy" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <symbols>
        <doc>
            Variables used throughout the document, e.g. dimensions or parameters.
        </doc>
        <symbol name="N_spectrum">
            <doc>
                Length of the spectrum array (e.g. wavelength or energy) of the measured
                data.
            </doc>
        </symbol>
        <symbol name="N_measurements">
            <doc>
                Number of measurements (1st dimension of measured data arrays). This is
                equal to the number of parameters scanned. For example, if the experiment
                was performed at three different temperatures and two different pressures
                N_measurements = 2*3 = 6.
            </doc>
        </symbol>
    </symbols>
    <doc>
        A general application definition of optical spectroscopy elements, which may
        be used as a template to derive specialized optical spectroscopy experiments.
        
        Possible specializations are ellipsometry, Raman spectroscopy, photoluminescence,
        reflectivity/transmission spectroscopy.
        
        A general optical experiment consists of (i) a light/photon source, (ii) a sample,
        (iii) a detector.
        
        For any free-text descriptions, it is recommended to use English, as this ensures
        the most FAIR (Findable, Accessible, Interoperable, and Reusable) representation of the information.
    </doc>
    <group type="NXentry">
        <field name="definition">
            <doc>
                An application definition describing a general optical experiment.
            </doc>
            <attribute name="version">
                <doc>
                    Version number to identify which definition of this application
                    definition was used for this entry/data.
                </doc>
            </attribute>
            <attribute name="URL">
                <doc>
                    URL where to find further material (documentation, examples) relevant
                    to the application definition.
                </doc>
            </attribute>
            <enumeration>
                <item value="NXoptical_spectroscopy"/>
            </enumeration>
        </field>
        <field name="title" recommended="true"/>
        <field name="start_time" type="NX_DATE_TIME" recommended="true">
            <doc>
                Datetime of the start of the measurement.
                Should be a ISO8601 date/time stamp. It is recommended to add an explicit time zone,
                otherwise, the local time zone is assumed per ISO8601.
                
                It is required to enter at least one of both measurement times, either "start_time" or "end_time".
            </doc>
        </field>
        <field name="end_time" type="NX_DATE_TIME" recommended="true">
            <doc>
                Datetime of the end of the measurement.
                Should be a ISO8601 date/time stamp. It is recommended to add an explicit time zone,
                otherwise the local time zone is assumed per ISO8601.
                
                It is required to enter at least one of both measurement times, either "start_time" or "end_time".
            </doc>
        </field>
        <field name="identifier_experiment" recommended="true"/>
        <field name="experiment_description" optional="true">
            <doc>
                An optional free-text description of the experiment.
                
                Users are strongly advised to parameterize the description of their experiment
                by using respective groups and fields and base classes instead of writing prose
                into this field.
                
                The reason is that such a free-text field is difficult to machine-interpret.
                The motivation behind keeping this field for now is to learn how far the
                current base classes need extension based on user feedback.
            </doc>
        </field>
        <field name="experiment_type">
            <doc>
                Specify the type of the optical experiment.
                
                Use another term if none of these methods are suitable. You may specify
                fundamental characteristics or properties in the experimental sub-type.
                
                For Raman spectroscopy or ellipsometry use the respective specializations
                of NXoptical_spectroscopy.
            </doc>
            <enumeration open="true">
                <item value="photoluminescence"/>
                <item value="transmission spectroscopy"/>
                <item value="reflection spectroscopy"/>
            </enumeration>
        </field>
        <field name="experiment_sub_type" optional="true">
            <doc>
                Specify a special property or characteristic of the experiment, which specifies
                the generic experiment type.
            </doc>
            <enumeration open="true">
                <item value="time resolved"/>
                <item value="imaging"/>
                <item value="pump-probe"/>
            </enumeration>
        </field>
        <group name="beam_ref_frame" type="NXcoordinate_system" optional="true">
            <field name="depends_on" type="NX_CHAR">
                <doc>
                    This refers to the coordinate system along the beam path. The origin and
                    base is defined at z=0, where the incident beam hits the sample at the surface.
                </doc>
            </field>
            <group type="NXtransformations">
                <doc>
                    This is the default NeXus coordinate system (McStas), if the transformation
                    does not change the coordinate system at all - i.e. it is unity.
                    Otherwise, by this a respective transformation of the beam
                    reference frame to the default reference frame could be made. i.e.
                    exchange of x and z coordinate, rotation of respective coordinates
                    towards each other.
                </doc>
            </group>
        </group>
        <group name="sample_normal_ref_frame" type="NXcoordinate_system" optional="true">
            <field name="depends_on" type="NX_CHAR">
                <doc>
                    Link to transformations defining the sample-normal base coordinate system,
                    which is defined such that the positive z-axis is parallel to the sample normal,
                    and the x-y-plane lies inside the sample surface.
                </doc>
            </field>
            <group type="NXtransformations">
                <doc>
                    Set of transformations, describing the orientation of the sample-normal coordinate system
                    with respect to the beam coordinate system (.).
                </doc>
            </group>
        </group>
        <group type="NXuser" minOccurs="0" maxOccurs="unbounded">
            <doc>
                Contact information and eventually details of at persons who
                performed the measurements. This can be for example the principal
                investigator or student. Examples are: name, affiliation, address, telephone
                number, email, role as well as identifiers such as orcid or similar.
                It is recommended to add multiple users if relevant.
                
                Due to data privacy concerns, there is no minimum requirement.
                If no user with specific name is allowed to be given, it is required to
                assign at least an affiliation
            </doc>
        </group>
        <group type="NXinstrument">
            <doc>
                Devices or elements of the optical spectroscopy setup described with its
                properties and general information.
                
                This includes for example:
                - The beam device's or instrument's model, company, serial number, construction year, etc.
                - Used software or code
                - Experiment descriptive parameters as reference frames, resolution, calibration
                - Photon beams with their respective properties such as angles and polarization
                - Various optical beam path devices, which interact, manipulate or measure optical beams
                - Characteristics of the medium surrounding the sample
                - "Beam devices" for a beam path description
                - Stages(NXmanipulator)
                - Sensors and actuators to control or measure sample or beam properties
            </doc>
            <group name="beam_TYPE" type="NXbeam" nameType="partial" minOccurs="1" maxOccurs="unbounded">
                <doc>
                    This can be used to describe properties of a photon beam.
                    A beam can be connected to components, via their
                    "inputs" and "outputs".
                    
                    It is required to define at least one incident beam which is incident
                    to the sample. You may specify if this beam parameters are actually measured
                    or just nominal.
                    If this beam is the output of a source, chose the same
                    name appendix as for the NXsource instance (e.g. TYPE=532nm)
                </doc>
                <field name="parameter_reliability">
                    <doc>
                        Select the reliability of the respective beam characteristics. Either,
                        the parameters are measured via another device or method or just given
                        nominally via the properties of a light source properties (532nm, 100mW).
                    </doc>
                    <enumeration>
                        <item value="measured"/>
                        <item value="nominal"/>
                    </enumeration>
                </field>
                <field name="incident_wavelength" type="NX_NUMBER" recommended="true"/>
                <field name="incident_wavelength_spread" type="NX_NUMBER" recommended="true"/>
                <field name="incident_polarization" type="NX_NUMBER" recommended="true"/>
                <field name="extent" type="NX_FLOAT" recommended="true"/>
                <field name="associated_source" type="NX_CHAR" optional="true">
                    <doc>
                        The path to the device which emitted this beam (light source or frequency doubler).
                        
                        This parameter is recommended, if the previous optical element is a photon source.
                        In this way, the properties of the laser or light source can be described
                        and associated.
                        The beam should be named with the same appendix as the source, e.g.,
                        for TYPE=532nmlaser, there should be both a NXsource named
                        "source_532nmlaser" and a NXbeam named "beam_532nmlaser".
                        
                        Example: /entry/instrument/source_532nmlaser
                    </doc>
                </field>
                <field name="beam_polarization_type" optional="true">
                    <enumeration>
                        <item value="linear"/>
                        <item value="circular"/>
                        <item value="elliptically"/>
                        <item value="unpolarized"/>
                    </enumeration>
                </field>
                <field name="linear_beam_sample_polarization" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                    <doc>
                        Angle of the linear polarized light, with respect to a fixed arbitrary
                        defined 0° position. Note that the zero reference should be a direction vector for a
                        :ref:`reference_plane &lt;/NXbeam/TRANSFORMATIONS/reference_plane-field&gt;`
                        normal in an :ref:`NXtransformations` group within :ref:`NXbeam`.
                        This can be used if no definition of respective
                        coordinate systems for beam and sample normal is done. If coordinate systems
                        are defined, refer to beam "incident_polarization".
                    </doc>
                </field>
            </group>
            <group name="detector_TYPE" type="NXdetector" nameType="partial" minOccurs="1" maxOccurs="unbounded">
                <field name="detector_channel_type">
                    <enumeration>
                        <item value="single-channel"/>
                        <item value="multichannel"/>
                    </enumeration>
                </field>
                <field name="detector_type" recommended="true">
                    <doc>
                        Description of the detector type.
                    </doc>
                    <enumeration open="true">
                        <item value="CCD"/>
                        <item value="photomultiplier"/>
                        <item value="photodiode"/>
                        <item value="avalanche-photodiode"/>
                        <item value="streak camera"/>
                        <item value="bolometer"/>
                        <item value="golay detectors"/>
                        <item value="pyroelectric detector"/>
                        <item value="deuterated triglycine sulphate"/>
                    </enumeration>
                </field>
                <group name="raw_data" type="NXdata" recommended="true">
                    <doc>
                        Contains the raw data collected by the detector before calibration.
                        The data which is considered raw might change from experiment to experiment
                        due to hardware pre-processing of the data.
                        This field ideally collects the data with the lowest level of processing
                        possible.
                    </doc>
                    <attribute name="signal">
                        <enumeration>
                            <item value="raw"/>
                        </enumeration>
                    </attribute>
                    <field name="raw" type="NX_NUMBER">
                        <doc>
                            Raw data before calibration.
                        </doc>
                    </field>
                </group>
                <field name="additional_detector_hardware" optional="true">
                    <doc>
                        Specify respective hardware which was used for the detector. For
                        example special electronics required for time-correlated single photon
                        counting (TCSPC).
                    </doc>
                </field>
                <group name="device_information" type="NXfabrication" recommended="true"/>
            </group>
            <group name="source_TYPE" type="NXsource" nameType="partial" recommended="true">
                <field name="type" recommended="true">
                    <enumeration open="true">
                        <item value="Synchrotron X-ray Source"/>
                        <item value="Rotating Anode X-ray"/>
                        <item value="Fixed Tube X-ray"/>
                        <item value="UV Laser"/>
                        <item value="Optical Laser"/>
                        <item value="Laser"/>
                        <item value="Dye-Laser"/>
                        <item value="Broadband Tunable Light Source"/>
                        <item value="Halogen lamp"/>
                        <item value="LED"/>
                        <item value="Mercury Cadmium Telluride"/>
                        <item value="Deuterium Lamp"/>
                        <item value="Xenon Lamp"/>
                        <item value="Globar"/>
                    </enumeration>
                </field>
                <field name="name" recommended="true"/>
                <field name="standard" optional="true">
                    <doc>
                        If available, name/ID/norm of the light source standard.
                    </doc>
                </field>
                <group name="device_information" type="NXfabrication" recommended="true">
                    <doc>
                        Details about the device information.
                    </doc>
                </group>
                <field name="associated_beam" type="NX_CHAR" recommended="true">
                    <doc>
                        The path to a beam emitted by this source.
                        Should be named with the same appendix, e.g.,
                        for TYPE=532nmlaser, there should as well be
                        a NXbeam named "beam_532nmlaser" together with this source
                        instance named "source_532nmlaser"
                        
                        Example: /entry/instrument/beam_532nmlaser
                    </doc>
                </field>
            </group>
            <group type="NXmonochromator" recommended="true">
                <group name="device_information" type="NXfabrication" recommended="true"/>
            </group>
            <field name="angle_reference_frame" recommended="true">
                <doc>
                    Defines the reference frame which is used to describe the sample orientation
                    with respect to the beam directions.
                    
                    A beam centered description is the default and uses 4 angles(similar to XRD):
                      - Omega (angle between sample surface and incident beam)
                      - 2Theta (angle between the transmitted beam and the detection beam)
                      - Chi (sample tilt angle, angle between plane#1 and the surface normal,
                            plane#1 = spanned by incidence beam and detection
                            and detection. If Chi=0°, then plane#1 is the plane of
                            incidence in reflection setups)
                      - Phi (inplane rotation of sample, rotation axis is the samples
                            surface normal)
                    
                    
                    A sample normal centered description is possible as well:
                      - angle of incidence (angle between incident beam and sample surface)
                      - angle of detection (angle between detection beam and sample surface)
                      - angle of incident and detection beam
                      - angle of in-plane sample rotation (direction along the sample's surface normal)
                </doc>
                <enumeration>
                    <item value="beam centered"/>
                    <item value="sample-normal centered"/>
                </enumeration>
            </field>
            <field name="omega" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Angle between sample incident beam and sample surface.
                </doc>
            </field>
            <field name="twotheta" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Angle between incident and detection beam
                </doc>
            </field>
            <field name="chi" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Sample tilt between sample normal, and the plane spanned by detection and
                    incident beam.
                </doc>
            </field>
            <field name="phi" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Inplane rotation of the sample, with rotation axis along sample normal.
                </doc>
            </field>
            <field name="angle_of_incidence" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Angle(s) of the incident beam vs. the normal of the bottom reflective
                    (substrate) surface in the sample. These two directions span the plane
                    of incidence.
                </doc>
            </field>
            <field name="angle_of_detection" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Detection angle(s) of the beam reflected or scattered off the sample
                    vs. the normal of the bottom reflective (substrate) surface in the
                    sample if not equal to the angle(s) of incidence.
                    These two directions span the plane of detection.
                </doc>
            </field>
            <field name="angle_of_incident_and_detection_beam" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Angle between the incident and detection beam.
                    If angle_of_detection + angle_of_incidence = angle_of_incident_and_detection_beam,
                    then the setup is a reflection setup.
                    If angle_of_detection + angle_of_incidence != angle_of_incident_and_detection_beam
                    then the setup may be a light scattering setup.
                    (i.e. 90° + 90° != 90°, i.e. incident and detection beam in the sample surface, but
                    the angle source-sample-detector is 90°)
                </doc>
            </field>
            <field name="angle_of_in_plane_sample_rotation" type="NX_NUMBER" optional="true" units="NX_ANGLE">
                <doc>
                    Angle of the inplane orientation of the sample. This might be an arbitrary,
                    angle without specific relation to the sample symmetry,
                    of the angle to a specific sample property (i.e. crystallographic axis or sample
                    shape such as wafer flat)
                </doc>
            </field>
            <group name="generic_beam_sample_angle_TYPE" type="NXtransformations" nameType="partial" recommended="true">
                <doc>
                    Set of transformations, describing the relative orientation of different
                    parts of the experiment (beams or sample). You may select one of the specified
                    angles for incident and detection beam or sample, and then use polar and azimuthal
                    angles to define the direction via spherical coordinates.
                    This allows consistent definition between different coordinate system.
                    You may refer to self defined coordinate system as well.
                    
                    
                    If "angle_reference_frame = beam centered", then this coordinate system is used:
                    McStas system (NeXus default)
                    (https://manual.nexusformat.org/design.html#mcstas-and-nxgeometry-system)
                    
                    i.e. the z-coordinate math:`[0,0,1]` is along the incident beam direction and
                    the x-coordinate math:`[1,0,0]` is in the horizontal plane. Hence, usually math:`[0,1,0]`
                    is vertically oriented.
                    
                    If "angle_reference_frame = sample-normal centered", then this coordinate
                    system is used
                    z - math:`[0,0,1]` along sample surface normal
                    x - math:`[1,0,0]` defined by sample surface projected incident beam.
                    y - math:`[0,1,0]` in the sample surface, orthogonal to z and x.
                    For this case, x may be ill defined, if the incident beam is perpendicular
                    to the sample surface. In this case, use the beam centered description.
                </doc>
                <field name="type">
                    <enumeration>
                        <item value="incident beam"/>
                        <item value="detection beam"/>
                        <item value="sample"/>
                    </enumeration>
                </field>
                <field name="polar" type="NX_NUMBER" units="NX_ANGLE">
                    <doc>
                        Rotation about the y axis (polar rotation within the sample plane).
                    </doc>
                    <attribute name="transformation_type">
                        <enumeration>
                            <item value="rotation"/>
                        </enumeration>
                    </attribute>
                    <attribute name="vector">
                        <enumeration>
                            <item value="[0, 1, 0]"/>
                        </enumeration>
                    </attribute>
                    <attribute name="depends_on">
                        <doc>
                            Path to a transformation that places the sample surface
                            into the origin of the arpes_geometry coordinate system.
                        </doc>
                    </attribute>
                </field>
                <field name="azimuth" type="NX_NUMBER" units="NX_ANGLE">
                    <doc>
                        Rotation about the z axis (azimuthal rotation within the sample plane).
                    </doc>
                    <attribute name="transformation_type">
                        <enumeration>
                            <item value="rotation"/>
                        </enumeration>
                    </attribute>
                    <attribute name="vector">
                        <enumeration>
                            <item value="[0, 0, 1]"/>
                        </enumeration>
                    </attribute>
                    <attribute name="depends_on">
                        <enumeration>
                            <item value="offset_tilt"/>
                        </enumeration>
                    </attribute>
                </field>
            </group>
            <field name="lateral_focal_point_offset" type="NX_NUMBER" optional="true" units="NX_LENGTH">
                <doc>
                    Specify if there is a lateral offset on the sample surface, between the focal
                    points of the incident beam and the detection beam.
                </doc>
            </field>
            <group type="NXcomponent" minOccurs="0" maxOccurs="unbounded">
                <doc>
                    Optical components along the optical beam path.
                    
                    Every object which interacts or modifies optical beam properties,
                    may be a component, e.g. Filter, Window, Beamsplitter, Photon Source,
                    Detector, etc,
                </doc>
            </group>
            <group type="NXoptical_lens" optional="true">
                <doc>
                    This is the optical element used to focus or collect light. This may
                    be a generic lens or microcope objectives which are used for the
                    Raman scattering process.
                </doc>
                <field name="type">
                    <enumeration open="true">
                        <item value="objective"/>
                        <item value="lens"/>
                        <item value="glass fiber"/>
                        <item value="none"/>
                    </enumeration>
                </field>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group type="NXwaveplate" optional="true"/>
            <group type="NXoptical_window" optional="true"/>
            <group name="polfilter_TYPE" type="NXcomponent" optional="true" nameType="partial">
                <doc>
                    Polarization filter to prepare light to be measured or to be incident
                    on the sample.
                    Generic polarization filter properties may be implemented via NXfilter_pol
                    at a later stage.
                </doc>
                <field name="filter_mechanism" type="NX_CHAR" optional="true">
                    <doc>
                        Physical principle of the polarization filter used to create a
                        defined incident or scattered light state.
                    </doc>
                    <enumeration open="true">
                        <item value="polarization by Fresnel reflection"/>
                        <item value="birefringent polarizers"/>
                        <item value="thin film polarizers"/>
                        <item value="wire-grid polarizers"/>
                    </enumeration>
                </field>
                <field name="specific_polarization_filter_type" type="NX_CHAR" optional="true">
                    <doc>
                        Specific name or type of the polarizer used.
                        
                        Free text, for example: Glan-Thompson, Glan-Taylor, Rochon Prism, Wollaston
                        Polarizer...
                    </doc>
                </field>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group name="spectralfilter_TYPE" type="NXcomponent" optional="true" nameType="partial">
                <doc>
                    Spectral filter used to modify properties of the scattered or incident light.
                </doc>
                <field name="filter_type" optional="true">
                    <doc>
                        Type of laser-line filter used to suppress the laser, if measurements
                        close to the laser-line are performed.
                    </doc>
                    <enumeration open="true">
                        <item value="long-pass filter">
                            <doc>Blocks shorter wavelengths and transmits longer wavelengths.</doc>
                        </item>
                        <item value="short-pass filter">
                            <doc>Blocks longer wavelengths and transmits shorter wavelengths.</doc>
                        </item>
                        <item value="notch filter">
                            <doc>Blocks a narrow wavelength band while transmitting others.</doc>
                        </item>
                        <item value="reflection filter">
                            <doc>Reflects certain wavelength ranges instead of absorbing them.</doc>
                        </item>
                        <item value="neutral density filter">
                            <doc>Reduces light intensity uniformly across all wavelengths.</doc>
                        </item>
                    </enumeration>
                </field>
                <field name="intended_use" optional="true">
                    <doc>
                        Type of laser-line filter used to suppress the laser, if measurements
                        close to the laser-line are performed.
                    </doc>
                    <enumeration open="true">
                        <item value="laser line cleanup"/>
                        <item value="raylight line removal"/>
                        <item value="spectral filtering"/>
                        <item value="intensity manipulation"/>
                    </enumeration>
                </field>
                <group name="filter_characteristics" type="NXdata" optional="true">
                    <doc>
                        Properties of the spectral filter such as wavelength dependent transmission
                        or reflectivity.
                    </doc>
                    <attribute name="characteristics_type" optional="true">
                        <doc>
                            Which property is used to form the spectral properties of light,
                            i.e. transmission or reflection properties.
                        </doc>
                        <enumeration>
                            <item value="transmission"/>
                            <item value="reflection"/>
                        </enumeration>
                    </attribute>
                </group>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group type="NXbeam_transfer_matrix_table" optional="true">
                <doc>
                    Allows description of beam properties via matrices, which relate ingoing with
                    outgoing beam properties.
                </doc>
            </group>
            <group name="sample_stage" type="NXmanipulator" optional="true">
                <doc>
                    Sample stage (or manipulator) for positioning of the sample. This should
                    only contain the spatial orientation of movement.
                </doc>
                <field name="stage_type" optional="true">
                    <doc>
                        Specify the type of the sample stage.
                    </doc>
                    <enumeration open="true">
                        <item value="manual stage"/>
                        <item value="scanning stage"/>
                        <item value="liquid stage"/>
                        <item value="gas cell"/>
                        <item value="cryostat"/>
                        <item value="heater"/>
                    </enumeration>
                </field>
                <group name="transformations" type="NXtransformations" optional="true">
                    <doc>
                        This allows a description of the stages relation or orientation and
                        position with respect to the sample or beam, if an laboratory or
                        an stage coordinate system is defined.
                    </doc>
                </group>
                <field name="beam_sample_relation" optional="true">
                    <doc>
                        Description of relation of the beam with the sample. How does the
                        sample hit the beam, e.g. 'center of sample, long edge parallel
                        to the plane of incidence'.
                        This is redundant if a full orientation description is done via the
                        stage's "transformations" entry.
                    </doc>
                </field>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group name="temperature_sensor" type="NXsensor" recommended="true">
                <field name="name" recommended="true"/>
                <field name="measurement">
                    <enumeration>
                        <item value="temperature"/>
                    </enumeration>
                </field>
                <field name="type" optional="true"/>
                <field name="value" type="NX_FLOAT"/>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group name="temp_control_TYPE" type="NXactuator" nameType="partial" optional="true">
                <doc>
                    Type of control for the sample temperature. Replace TYPE by "cryostat" or
                    "heater" to specify it.
                </doc>
                <field name="name" recommended="true"/>
                <field name="physical_quantity">
                    <enumeration>
                        <item value="temperature"/>
                    </enumeration>
                </field>
                <field name="cooler_or_heater" recommended="true">
                    <enumeration>
                        <item value="cooler"/>
                        <item value="heater"/>
                    </enumeration>
                </field>
                <field name="type" optional="true">
                    <doc>
                        Hardware used for actuation, i.e. laser, gas lamp, filament, resistive
                    </doc>
                </field>
                <group type="NXpid_controller" recommended="true">
                    <field name="setpoint" type="NX_FLOAT" recommended="true"/>
                </group>
                <group name="device_information" type="NXfabrication" optional="true"/>
            </group>
            <group name="device_information" type="NXfabrication" recommended="true">
                <doc>
                    General device information of the optical spectroscopy setup, if
                    suitable (e.g. for a tabletop spectrometer or other non-custom build setups).
                    For custom build setups, this may be limited to the construction year.
                </doc>
                <field name="vendor" recommended="true"/>
                <field name="model" recommended="true"/>
                <field name="identifier" recommended="true"/>
                <field name="construction_year" type="NX_DATE_TIME" optional="true"/>
            </group>
            <group name="software_TYPE" type="NXprogram" nameType="partial" recommended="true">
                <field name="program">
                    <doc>
                        Commercial or otherwise defined given name of the program that was
                        used to control any parts of the optical spectroscopy setup.
                        The uppercase TYPE should be replaced by a specification name, i.e.
                        "software_detector" or "software_stage" to specify the respective
                        program or software components.
                    </doc>
                    <attribute name="version" recommended="true">
                        <doc>
                            Either version with build number, commit hash, or description of a
                            (online) repository where the source code of the program and build
                            instructions can be found so that the program can be configured in
                            such a way that result files can be created ideally in a
                            deterministic manner.
                        </doc>
                    </attribute>
                    <attribute name="URL" optional="true">
                        <doc>
                            Description of the software by persistent resource, where the program,
                            code, script etc. can be found.
                        </doc>
                    </attribute>
                </field>
            </group>
            <group name="instrument_calibration_DEVICE" type="NXcalibration" nameType="partial" recommended="true">
                <doc>
                    Pre-calibration of an arbitrary device of the instrumental setup, which
                    has the name DEVICE. You can specify here how, at which time by which method
                    the calibration was done. As well the accuracy and a link to the calibration
                    dataset.
                </doc>
                <field name="device_path" recommended="true">
                    <doc>
                        Path to the device, which was calibrated.
                        Example: entry/instrument/DEVICE
                    </doc>
                </field>
                <group name="calibration_accuracy" type="NXdata" optional="true">
                    <doc>
                        Provide data about the determined accuracy of the device, this may
                        may be a single value or a dataset like wavelength error vs. wavelength etc.
                    </doc>
                </group>
                <field name="calibration_status" type="NX_CHAR" recommended="true">
                    <doc>
                        Was a calibration performed? If yes, when was it done? If the
                        calibration time is provided, it should be specified in
                        calibration_time.
                    </doc>
                    <enumeration>
                        <item value="calibration time provided"/>
                        <item value="no calibration"/>
                        <item value="within 1 hour"/>
                        <item value="within 1 day"/>
                        <item value="within 1 week"/>
                    </enumeration>
                </field>
                <field name="calibration_time" type="NX_DATE_TIME" optional="true">
                    <doc>
                        If calibration status is 'calibration time provided', specify the
                        ISO8601 date when calibration was last performed before this
                        measurement. UTC offset should be specified.
                    </doc>
                </field>
                <group type="NXdata" optional="true">
                    <doc>
                        Generic data which does not fit to the 'NX_FLOAT' fields in NXproces.
                        This can be for example the instrument response function.
                    </doc>
                </group>
            </group>
            <group name="wavelength_resolution" type="NXresolution" optional="true">
                <doc>
                    The overall resolution of the optical instrument.
                </doc>
                <field name="physical_quantity">
                    <enumeration>
                        <item value="wavelength"/>
                    </enumeration>
                </field>
                <field name="type" recommended="true"/>
                <field name="resolution" type="NX_FLOAT" units="NX_WAVELENGTH">
                    <doc>
                        Minimum distinguishable wavelength separation of peaks in spectra.
                    </doc>
                </field>
            </group>
        </group>
        <group type="NXsample">
            <doc>
                Properties of the sample, such as sample type, layer structure,
                chemical formula, atom types, its history etc.
                Information about the sample stage and sample environment should be
                described in ENTRY/INSTRUMENT/sample_stage.
            </doc>
            <field name="name"/>
            <field name="sample_id" recommended="true">
                <doc>
                    Locally unique ID of the sample, used in the research institute or group.
                </doc>
            </field>
            <field name="physical_form" recommended="true">
                <doc>
                    State the form of the sample, examples are:
                    thin film, single crystal, poly crystal, amorphous, single layer,
                    multi layer, liquid, gas, pellet, powder.
                    Generic properties of liquids or gases see NXsample properties.
                </doc>
            </field>
            <field name="description" optional="true">
                <doc>
                    Free text description of the sample.
                </doc>
            </field>
            <field name="chemical_formula" recommended="true">
                <doc>
                    Chemical formula of the sample. Use the Hill system (explained here:
                    https://en.wikipedia.org/wiki/Chemical_formula#Hill_system) to write
                    the chemical formula. In case the sample consists of several layers,
                    this should be a list of the chemical formulas of the individual
                    layers, where the first entry is the chemical formula of the top
                    layer (the one on the front surface, on which the light incident).
                    The order must be consistent with layer_structure
                </doc>
            </field>
            <field name="atom_types" optional="true">
                <doc>
                    List of comma-separated elements from the periodic table that are
                    contained in the sample. If the sample substance has multiple
                    components, all elements from each component must be included in
                    'atom_types'.
                </doc>
            </field>
            <field name="preparation_date" type="NX_DATE_TIME" recommended="true">
                <doc>
                    ISO 8601 time code with local time zone offset to UTC information
                    when the specimen was prepared.
                    
                    Ideally, report the end of the preparation, i.e. the last known timestamp when
                    the measured specimen surface was actively prepared.
                </doc>
            </field>
            <group name="history" type="NXhistory" recommended="true">
                <doc>
                    A set of activities that occurred to the sample prior to/during the experiment.
                </doc>
            </group>
            <group name="temperature_env" type="NXenvironment" recommended="true">
                <doc>
                    Sample temperature (either controlled or just measured).
                </doc>
                <field name="temperature_nominal" optional="true">
                    <doc>
                        If no sensor was available for the determination of temperature, selected
                        a nominal value which represents approximately the situation of sample temperature.
                    </doc>
                    <enumeration open="true">
                        <item value="room temperature"/>
                        <item value="liquid helium temperature"/>
                        <item value="liquid nitrogen temperature"/>
                    </enumeration>
                </field>
                <group name="temperature_sensor" type="NXsensor" recommended="true">
                    <doc>
                        Temperature sensor measuring the sample temperature.
                        This should be a link to /entry/instrument/manipulator/temperature_sensor.
                    </doc>
                </group>
                <group name="sample_heater" type="NXactuator" optional="true">
                    <doc>
                        Device to heat the sample.
                        This should be a link to /entry/instrument/manipulator/sample_heater.
                    </doc>
                </group>
                <group name="sample_cooler" type="NXactuator" optional="true">
                    <doc>
                        Device for cooling the sample (Cryostat, Airflow cooler, etc.).
                        This should be a link to /entry/instrument/manipulator/cryostat.
                    </doc>
                </group>
            </group>
            <group type="NXenvironment" optional="true">
                <doc>
                    Arbitrary sample property which may be varied during the experiment
                    and controlled by a device. Examples are pressure, voltage, magnetic field etc.
                    Similar to the temperature description of the sample.
                </doc>
                <field name="sample_medium" recommended="true">
                    <doc>
                        Medium, in which the sample is placed.
                    </doc>
                    <enumeration open="true">
                        <item value="air"/>
                        <item value="vacuum"/>
                        <item value="inert atmosphere"/>
                        <item value="oxidising atmosphere"/>
                        <item value="reducing atmosphere"/>
                        <item value="sealed can"/>
                        <item value="water"/>
                    </enumeration>
                </field>
                <field name="sample_medium_refractive_indices" type="NX_FLOAT" optional="true" units="NX_UNITLESS">
                    <doc>
                        Array of pairs of complex refractive indices n + ik of the medium
                        for every measured spectral point/wavelength/energy.
                        Only necessary if the measurement was performed not in air, or
                        something very well known, e.g. high purity water.
                    </doc>
                    <dimensions rank="2">
                        <dim index="1" value="2"/>
                        <dim index="2" value="N_spectrum"/>
                    </dimensions>
                </field>
            </group>
            <field name="thickness" type="NX_NUMBER" optional="true" units="NX_LENGTH">
                <doc>
                    (Measured) sample thickness.
                    
                    The information is recorded to qualify if the light used was likely
                    able to shine through the sample.
                    
                    In this case the value should be set to the actual thickness of
                    the specimen viewed for an illumination situation where the nominal
                    surface normal of the specimen is parallel to the optical axis.
                </doc>
            </field>
            <field name="thickness_determination" optional="true">
                <doc>
                    If a thickness if given, please specify how this thickness was estimated or
                    determined.
                </doc>
            </field>
            <field name="layer_structure" optional="true">
                <doc>
                    Qualitative description of the layer structure for the sample,
                    starting with the top layer (i.e. the one on the front surface, on
                    which the light incident), e.g. native oxide/bulk substrate, or
                    Si/native oxide/thermal oxide/polymer/peptide.
                </doc>
            </field>
            <field name="sample_orientation" optional="true">
                <doc>
                    Specify the sample orientation, how is its sample normal oriented
                    relative in the laboratory reference frame, incident beam reference
                    frame.
                </doc>
            </field>
            <field name="substrate" recommended="true">
                <doc>
                    If the sample is grown or fixed on a substrate, specify this here by
                    a free text description.
                </doc>
            </field>
        </group>
        <group type="NXdata">
            <doc>
                Here generic types of data may be saved. This may refer to data derived
                from single or multiple raw measurements (i.e. several intensities are
                evaluated for different parameters: ellipsometry -&gt; psi and delta) -
                i.e. non-raw data.
                As well plottable data may be stored/linked here, which provides the most suitable
                representation of the data (for the respective community).
                
                You may provide multiple instances of NXdata
            </doc>
            <attribute name="axes">
                <doc>
                    Spectrum, i.e. x-axis of the data (e.g. wavelength, energy etc.)
                </doc>
            </attribute>
            <attribute name="signal">
                <doc>
                    Spectrum, i.e. y-axis of the data (e.g. counts, intensity)
                </doc>
            </attribute>
        </group>
        <group name="measurement_data_calibration_TYPE" type="NXprocess" nameType="partial" recommended="true">
            <group name="wavelength_calibration" type="NXcalibration" optional="true">
                <field name="calibrated_axis" type="NX_FLOAT" recommended="true">
                    <doc>
                        Calibrated wavelength axis.
                    </doc>
                </field>
            </group>
        </group>
        <group name="derived_parameters" type="NXprocess" optional="true">
            <doc>
                Parameters that are derived from the measured data.
            </doc>
            <field name="depolarization" type="NX_NUMBER" optional="true" units="NX_UNITLESS">
                <doc>
                    Light loss due to depolarization as a value in [0-1].
                </doc>
                <dimensions rank="3">
                    <dim index="1" value="N_measurements"/>
                    <dim index="2" value="1"/>
                    <dim index="3" value="N_spectrum"/>
                </dimensions>
            </field>
            <field name="jones_quality_factor" type="NX_NUMBER" optional="true" units="NX_UNITLESS">
                <doc>
                    Jones quality factor.
                </doc>
                <dimensions rank="3">
                    <dim index="1" value="N_measurements"/>
                    <dim index="2" value="1"/>
                    <dim index="3" value="N_spectrum"/>
                </dimensions>
            </field>
            <field name="reflectivity" type="NX_NUMBER" optional="true" units="NX_UNITLESS">
                <doc>
                    Reflectivity.
                </doc>
                <dimensions rank="3">
                    <dim index="1" value="N_measurements"/>
                    <dim index="2" value="1"/>
                    <dim index="3" value="N_spectrum"/>
                </dimensions>
            </field>
            <field name="transmittance" type="NX_NUMBER" optional="true" units="NX_UNITLESS">
                <doc>
                    Transmittance.
                </doc>
                <dimensions rank="3">
                    <dim index="1" value="N_measurements"/>
                    <dim index="2" value="1"/>
                    <dim index="3" value="N_spectrum"/>
                </dimensions>
            </field>
            <group name="ANALYSIS_program" type="NXprogram" nameType="partial" optional="true">
                <field name="program">
                    <doc>
                        Commercial or otherwise defined given name of the program that was
                        used to generate or calculate the derived parameters.
                        If home written, one can provide the actual steps in the NOTE
                        subfield here.
                    </doc>
                    <attribute name="version"/>
                </field>
            </group>
        </group>
    </group>
</definition>
