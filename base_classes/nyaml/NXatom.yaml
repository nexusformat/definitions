category: base
doc: |
  Base class for documenting a set of atoms.
  
  Atoms in the set may be bonded. The set may have
  a net charge to represent an ion.
  An ion can be a molecular ion.
symbols:
  doc: |
    The symbols used in the schema to specify e.g. dimensions of arrays.
  n_pos: |
    Number of atom positions.
  d: |
    Dimensionality
  n_ivec_max: |
    Maximum number of atoms/isotopes allowed per ion.
  n_ranges: |
    Number of mass-to-charge-state-ratio range intervals for ion type.
type: group
NXatom(NXobject):
  name(NX_CHAR):
    doc: |
      Given name for the set.
      
      This field could for example be used in the research field
      of atom probe tomography to store a standardized human-readable
      name of the element or ion like such as Al +++ or 12C +.
  id(NX_UINT):
    unit: NX_UNITLESS
    doc: |
      Given numerical identifier for  the set.
      
      The identifier zero is reserved for the special unknown ion type.
  identifier_chemical(NX_CHAR):
    doc: |
      Identifier used to refer to if the set of atoms represents a substance.
    enumeration: [inchi]
  charge(NX_NUMBER):
    unit: NX_CHARGE
    doc: |
      Signed net (partial) charge of the (molecular) ion.
      
      Different methods for computing charge are in use.
      Care needs to be exercised with respect to the integration.
      `T. A. Manz <10.1039/c6ra04656h>`_ and `N. G. Limas <10.1039/C6RA05507A>`_ discuss computational details.
  charge_state(NX_NUMBER):
    unit: NX_UNITLESS
    doc: |
      Charge reported in multiples of the charge of an electron.
      
      For research using atom probe tomography the value should be set to
      zero if the charge_state is unknown and irrecoverable. This can happen
      when classical ranging definition files in formats like RNG, RRNG are used.
      These file formats do not document the charge state explicitly but only
      the number of atoms of each element per molecular ion surplus the
      respective mass-to-charge-state-ratio interval.
      
      Details on ranging definition files in the literature are `M. K. Miller <https://doi.org/10.1002/sia.1719>`_.
  volume(NX_NUMBER):
    unit: NX_VOLUME
    doc: |
      Assumed volume affected by the set of atoms.
      
      Neither individual atoms nor a set of cluster of these have a volume
      that is unique as a some cut-off criterion is required.
  indices(NX_CHAR):
    doc: |
      Index for each atom at locations as detailed by position.
      Indices can be used as identifier and thus names for individual atoms.
    dimensions:
      rank: 1
      dim: (n_pos,)
  type(NX_UINT):
    unit: NX_UNITLESS
    doc: |
      Nuclide information for each atom at locations as detailed by position.
      
      One `approach <https://doi.org/10.1017/S1431927621012241>`_ for storing nuclide information
      efficiently is via individual hash values.
      Consult the docstring of ``nuclide_hash`` for further details.
    dimensions:
      rank: 1
      dim: (n_pos,)
  position(NX_NUMBER):
    unit: NX_ANY
    doc: |
      Position of each atom.
    dimensions:
      rank: 2
      dim: (n_pos, d)
    \@depends_on(NX_CHAR):
      doc: |
        Path to an instance of :ref:`NXcoordinate_system` to document
        the reference frame in which the positions are defined.
        
        This resolves ambiguity when the reference frame is different
        to the NeXus default reference frame (McStas).
  occupancy(NX_NUMBER):
    unit: NX_DIMENSIONLESS
    doc: |
      Relative occupancy of the atom position.
      
      This field is useful for specifying the atomic motif in
      instances of :ref:`NXunit_cell`.
    dimensions:
      rank: 1
      dim: (n_pos,)
  nuclide_hash(NX_UINT):
    unit: NX_UNITLESS
    doc: |
      Vector of nuclide hash values. The vector is sorted in decreasing order.
      
      Individual hash values :math:`H` `encode <https://doi.org/10.1017/S1431927621012241>`_
      for each nuclide or element the number of protons :math:`Z` and a constant :math:`c`
      via the following hashing rule :math:`H = Z + c \cdot 256`. :math:`Z` and :math:`c` must be 8-bit unsigned integers.
      
      The constant :math:`c` is either set to number of neutrons :math:`N` or to the special value 255.
      The special value 255 is used to refer to all isotopes of an element from the IUPAC periodic table.
      
      Some examples:
      
      * The element hydrogen (meaning irrespective which isotope), its hash value is :math:`H = 1 + 255 \cdot 256 = 65281`.
      * The :math:`^{1}H` hydrogen isotope (:math:`Z = 1, N = 0`), its hash value is :math:`H = 1 + 0 \cdot 256 = 1`.
      * The :math:`^{2}H` deuterium isotope (:math:`Z = 1, N = 1`), its hash value is :math:`H = 1 + 1 \cdot 256 = 257`.
      * The :math:`^{3}H` tritium isotope (:math:`Z = 1, N = 2`), its hash value is :math:`H = 1 + 2 \cdot 256 = 513`.
      * The :math:`^{99}Tc` technetium isotope (:math:`Z = 43, N = 56`), its hash value is :math:`H = 43 + 56 \cdot 256 = 14379`.
      
      The special hash value :math:`0` is a placeholder.
      
      This hashing rule implements a bitshift operation. The benefit is that this enables encoding of all
      currently known nuclides and elements efficiently into an 16-bit unsigned integer. Sufficient
      unused indices remain to case situations when new elements will be discovered.
    dimensions:
      rank: 1
      dim: (n_ivec_max,)
  nuclide_list(NX_UINT):
    unit: NX_UNITLESS
    doc: |
      Table which decodes the entries in nuclide_hash into a human-readable matrix
      instances for either nuclides or elements. Specifically, the first row specifies the
      nuclide mass number. When the nuclide_hash values are used this means
      the row should report the sum :math:`Z + N` or 0. The value 0 documents that
      an element from the IUPAC periodic table is meant.
      The second row specifies the number of protons :math:`Z`.
      The value 0 in this case documents a placeholder or that no element-specific
      information is relevant.
      
      Taking a carbon-14 nuclide as an example the mass number is 14.
      That is encoded as a column vector (14, 6).
      The array is stored matching the order of nuclide_hash.
    dimensions:
      rank: 2
      dim: (n_ivec_max, 2)
  mass_to_charge_range(NX_NUMBER):
    unit: NX_ANY
    doc: |
      Associated lower :math:`{\frac{m}{q}}_{min}` and upper :math:`{\frac{m}{q}}_{max}` bounds of the
      mass-to-charge-state ratio interval(s) :math:`[{\frac{m}{q}}_{min}, {\frac{m}{q}}_{max}]`.
      (boundaries inclusive). This field is primarily of interest for documenting :ref:`NXprocess`
      steps of indexing a ToF/mass-to-charge-state ratio histogram.
    dimensions:
      rank: 2
      dim: (n_ranges, 2)

# ++++++++++++++++++++++++++++++++++ SHA HASH ++++++++++++++++++++++++++++++++++
# 3e34106345f5362bb2054e1922a28101a0e963d2e2a1de6d03fa8905403dc0e6
# <?xml version="1.0" encoding="UTF-8"?>
# <?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
# <!--
# # NeXus - Neutron and X-ray Common Data Format
# #
# # Copyright (C) 2025-2025 NeXus International Advisory Committee (NIAC)
# #
# # This library is free software; you can redistribute it and/or
# # modify it under the terms of the GNU Lesser General Public
# # License as published by the Free Software Foundation; either
# # version 3 of the License, or (at your option) any later version.
# #
# # This library is distributed in the hope that it will be useful,
# # but WITHOUT ANY WARRANTY; without even the implied warranty of
# # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# # Lesser General Public License for more details.
# #
# # You should have received a copy of the GNU Lesser General Public
# # License along with this library; if not, write to the Free Software
# # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
# #
# # For further information, see http://www.nexusformat.org
# -->
# <definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXatom" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
#     <symbols>
#         <doc>
#             The symbols used in the schema to specify e.g. dimensions of arrays.
#         </doc>
#         <symbol name="n_pos">
#             <doc>
#                 Number of atom positions.
#             </doc>
#         </symbol>
#         <symbol name="d">
#             <doc>
#                 Dimensionality
#             </doc>
#         </symbol>
#         <symbol name="n_ivec_max">
#             <doc>
#                 Maximum number of atoms/isotopes allowed per ion.
#             </doc>
#         </symbol>
#         <symbol name="n_ranges">
#             <doc>
#                 Number of mass-to-charge-state-ratio range intervals for ion type.
#             </doc>
#         </symbol>
#     </symbols>
#     <doc>
#         Base class for documenting a set of atoms.
#         
#         Atoms in the set may be bonded. The set may have
#         a net charge to represent an ion.
#         An ion can be a molecular ion.
#     </doc>
#     <field name="name" type="NX_CHAR">
#         <doc>
#             Given name for the set.
#             
#             This field could for example be used in the research field
#             of atom probe tomography to store a standardized human-readable
#             name of the element or ion like such as Al +++ or 12C +.
#         </doc>
#     </field>
#     <field name="id" type="NX_UINT" units="NX_UNITLESS">
#         <doc>
#             Given numerical identifier for  the set.
#             
#             The identifier zero is reserved for the special unknown ion type.
#         </doc>
#     </field>
#     <field name="identifier_chemical" type="NX_CHAR">
#         <doc>
#             Identifier used to refer to if the set of atoms represents a substance.
#         </doc>
#         <enumeration>
#             <item value="inchi"/>
#         </enumeration>
#     </field>
#     <field name="charge" type="NX_NUMBER" units="NX_CHARGE">
#         <doc>
#             Signed net (partial) charge of the (molecular) ion.
#             
#             Different methods for computing charge are in use.
#             Care needs to be exercised with respect to the integration.
#             `T. A. Manz &lt;10.1039/c6ra04656h&gt;`_ and `N. G. Limas &lt;10.1039/C6RA05507A&gt;`_ discuss computational details.
#         </doc>
#     </field>
#     <field name="charge_state" type="NX_NUMBER" units="NX_UNITLESS">
#         <doc>
#             Charge reported in multiples of the charge of an electron.
#             
#             For research using atom probe tomography the value should be set to
#             zero if the charge_state is unknown and irrecoverable. This can happen
#             when classical ranging definition files in formats like RNG, RRNG are used.
#             These file formats do not document the charge state explicitly but only
#             the number of atoms of each element per molecular ion surplus the
#             respective mass-to-charge-state-ratio interval.
#             
#             Details on ranging definition files in the literature are `M. K. Miller &lt;https://doi.org/10.1002/sia.1719&gt;`_.
#         </doc>
#     </field>
#     <field name="volume" type="NX_NUMBER" units="NX_VOLUME">
#         <doc>
#             Assumed volume affected by the set of atoms.
#             
#             Neither individual atoms nor a set of cluster of these have a volume
#             that is unique as a some cut-off criterion is required.
#         </doc>
#     </field>
#     <field name="indices" type="NX_CHAR">
#         <doc>
#             Index for each atom at locations as detailed by position.
#             Indices can be used as identifier and thus names for individual atoms.
#         </doc>
#         <dimensions rank="1">
#             <dim index="1" value="n_pos"/>
#         </dimensions>
#     </field>
#     <field name="type" type="NX_UINT" units="NX_UNITLESS">
#         <doc>
#             Nuclide information for each atom at locations as detailed by position.
#             
#             One `approach &lt;https://doi.org/10.1017/S1431927621012241&gt;`_ for storing nuclide information
#             efficiently is via individual hash values.
#             Consult the docstring of ``nuclide_hash`` for further details.
#         </doc>
#         <dimensions rank="1">
#             <dim index="1" value="n_pos"/>
#         </dimensions>
#     </field>
#     <field name="position" type="NX_NUMBER" units="NX_ANY">
#         <doc>
#             Position of each atom.
#         </doc>
#         <dimensions rank="2">
#             <dim index="1" value="n_pos"/>
#             <dim index="2" value="d"/>
#         </dimensions>
#         <attribute name="depends_on" type="NX_CHAR">
#             <doc>
#                 Path to an instance of :ref:`NXcoordinate_system` to document
#                 the reference frame in which the positions are defined.
#                 
#                 This resolves ambiguity when the reference frame is different
#                 to the NeXus default reference frame (McStas).
#             </doc>
#         </attribute>
#     </field>
#     <field name="occupancy" type="NX_NUMBER" units="NX_DIMENSIONLESS">
#         <doc>
#             Relative occupancy of the atom position.
#             
#             This field is useful for specifying the atomic motif in
#             instances of :ref:`NXunit_cell`.
#         </doc>
#         <dimensions rank="1">
#             <dim index="1" value="n_pos"/>
#         </dimensions>
#     </field>
#     <field name="nuclide_hash" type="NX_UINT" units="NX_UNITLESS">
#         <doc>
#             Vector of nuclide hash values. The vector is sorted in decreasing order.
#             
#             Individual hash values :math:`H` `encode &lt;https://doi.org/10.1017/S1431927621012241&gt;`_
#             for each nuclide or element the number of protons :math:`Z` and a constant :math:`c`
#             via the following hashing rule :math:`H = Z + c \cdot 256`. :math:`Z` and :math:`c` must be 8-bit unsigned integers.
#             
#             The constant :math:`c` is either set to number of neutrons :math:`N` or to the special value 255.
#             The special value 255 is used to refer to all isotopes of an element from the IUPAC periodic table.
#             
#             Some examples:
#             
#             * The element hydrogen (meaning irrespective which isotope), its hash value is :math:`H = 1 + 255 \cdot 256 = 65281`.
#             * The :math:`^{1}H` hydrogen isotope (:math:`Z = 1, N = 0`), its hash value is :math:`H = 1 + 0 \cdot 256 = 1`.
#             * The :math:`^{2}H` deuterium isotope (:math:`Z = 1, N = 1`), its hash value is :math:`H = 1 + 1 \cdot 256 = 257`.
#             * The :math:`^{3}H` tritium isotope (:math:`Z = 1, N = 2`), its hash value is :math:`H = 1 + 2 \cdot 256 = 513`.
#             * The :math:`^{99}Tc` technetium isotope (:math:`Z = 43, N = 56`), its hash value is :math:`H = 43 + 56 \cdot 256 = 14379`.
#             
#             The special hash value :math:`0` is a placeholder.
#             
#             This hashing rule implements a bitshift operation. The benefit is that this enables encoding of all
#             currently known nuclides and elements efficiently into an 16-bit unsigned integer. Sufficient
#             unused indices remain to case situations when new elements will be discovered.
#         </doc>
#         <dimensions rank="1">
#             <dim index="1" value="n_ivec_max"/>
#         </dimensions>
#     </field>
#     <field name="nuclide_list" type="NX_UINT" units="NX_UNITLESS">
#         <doc>
#             Table which decodes the entries in nuclide_hash into a human-readable matrix
#             instances for either nuclides or elements. Specifically, the first row specifies the
#             nuclide mass number. When the nuclide_hash values are used this means
#             the row should report the sum :math:`Z + N` or 0. The value 0 documents that
#             an element from the IUPAC periodic table is meant.
#             The second row specifies the number of protons :math:`Z`.
#             The value 0 in this case documents a placeholder or that no element-specific
#             information is relevant.
#             
#             Taking a carbon-14 nuclide as an example the mass number is 14.
#             That is encoded as a column vector (14, 6).
#             The array is stored matching the order of nuclide_hash.
#         </doc>
#         <dimensions rank="2">
#             <dim index="1" value="n_ivec_max"/>
#             <dim index="2" value="2"/>
#         </dimensions>
#     </field>
#     <field name="mass_to_charge_range" type="NX_NUMBER" units="NX_ANY">
#         <doc>
#             Associated lower :math:`{\frac{m}{q}}_{min}` and upper :math:`{\frac{m}{q}}_{max}` bounds of the
#             mass-to-charge-state ratio interval(s) :math:`[{\frac{m}{q}}_{min}, {\frac{m}{q}}_{max}]`.
#             (boundaries inclusive). This field is primarily of interest for documenting :ref:`NXprocess`
#             steps of indexing a ToF/mass-to-charge-state ratio histogram.
#         </doc>
#         <dimensions rank="2">
#             <dim index="1" value="n_ranges"/>
#             <dim index="2" value="2"/>
#         </dimensions>
#     </field>
# </definition>
